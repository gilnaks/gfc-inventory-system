(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{9033:function(e,t,n){Promise.resolve().then(n.bind(n,5212))},5212:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return OrderPage}});var s=n(7437),r=n(2265),a=n(2899),l=n(6142),i=n(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,i.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),o=(0,i.Z)("IceCream",[["path",{d:"m7 11 4.08 10.35a1 1 0 0 0 1.84 0L17 11",key:"1v6356"}],["path",{d:"M17 7A5 5 0 0 0 7 7",key:"151p3v"}],["path",{d:"M17 7a2 2 0 0 1 0 4H7a2 2 0 0 1 0-4",key:"1sdaij"}]]),c=(0,i.Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),m=(0,i.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),x=(0,i.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),u=(0,i.Z)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);var p=n(3505),h=n(9883);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let g=(0,i.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var b=n(2549),f=n(8501),y=n(8939);function OrderPage(){var e,t,n,i;let[v,w]=(0,r.useState)(!1),[j,N]=(0,r.useState)(""),[k,_]=(0,r.useState)(null),[C,O]=(0,r.useState)([]),[S,q]=(0,r.useState)([]),[P,T]=(0,r.useState)(null),[F,I]=(0,r.useState)([]),[A,z]=(0,r.useState)("home"),[D,Z]=(0,r.useState)(!1),[M,L]=(0,r.useState)(!0),[E,U]=(0,r.useState)(""),[Q,R]=(0,r.useState)(""),[Y,H]=(0,r.useState)(!1),[V,G]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let initializeApp=async()=>{L(!0);let e=localStorage.getItem("order_authenticated"),t=localStorage.getItem("order_location");if("true"===e&&t)try{let e=JSON.parse(t);_(e),w(!0),await Promise.all([checkPendingOrders(e.id),fetchPastOrders(e.id),fetchProducts(e.brand_id)])}catch(e){console.error("Error parsing saved data:",e),clearSession()}setTimeout(()=>{L(!1)},800)};initializeApp()},[]),(0,r.useEffect)(()=>{P&&"products"===A&&z("home")},[P,A]),(0,r.useEffect)(()=>{if(!(null==k?void 0:k.brand_id))return;let e=a.O.channel("order-products-changes").on("postgres_changes",{event:"*",schema:"public",table:"products",filter:"brand_id=eq.".concat(k.brand_id)},()=>{D||fetchProducts(k.brand_id)}).subscribe();return()=>{a.O.removeChannel(e)}},[null==k?void 0:k.brand_id,D]);let B=(e=>{if(!(null==e?void 0:e.brand))return"blue";switch(e.brand.slug){case"mychoice":return"green";case"gelatofilipino":return"red";case"mang-sorbetes":return"yellow";default:return"blue"}})(k),clearSession=()=>{w(!1),_(null),O([]),q([]),T(null),z("home"),U(""),R(""),L(!1),localStorage.removeItem("order_authenticated"),localStorage.removeItem("order_location"),localStorage.removeItem("order_cart_draft")},handleLocationAuth=async e=>{e.preventDefault(),Z(!0),U("");try{let{data:e,error:t}=await a.O.from("locations").select("*, brand:brands(*)").eq("passkey",j).single();if(t)throw t;_(e),w(!0),localStorage.setItem("order_authenticated","true"),localStorage.setItem("order_location",JSON.stringify(e)),await Promise.all([checkPendingOrders(e.id),fetchPastOrders(e.id),fetchProducts(e.brand_id)])}catch(e){U("Invalid location passcode. Please try again."),N("")}finally{Z(!1)}},fetchProducts=async e=>{try{let{data:t,error:n}=await a.O.from("inventory_summary").select("*").eq("brand_id",e).order("category, product_name");if(n)throw n;O(t||[])}catch(e){console.error("Error fetching products:",e)}},checkPendingOrders=async e=>{try{let{data:t,error:n}=await a.O.from("customer_orders").select("\n          id, status, created_at, total_amount,\n          order_details (\n            id, product_id, quantity, unit_price,\n            products (id, name, price, unit)\n          )\n        ").eq("location_id",e).in("status",["pending","approved"]).order("created_at",{ascending:!1}).limit(1);if(n)throw n;t&&t.length>0?T(t[0]):T(null)}catch(e){console.error("Error checking pending orders:",e)}},fetchPastOrders=async e=>{try{let{data:t,error:n}=await a.O.from("customer_orders").select("\n          id, status, created_at, total_amount,\n          order_details (\n            id, product_id, quantity, unit_price,\n            products (id, name, price, unit)\n          )\n        ").eq("location_id",e).in("status",["released","cancelled"]).order("created_at",{ascending:!1});if(n)throw n;I(t||[])}catch(e){console.error("Error fetching past orders:",e)}},getAvailableStock=e=>e.available_stock||0,getCartItemAvailableStock=e=>{let t=C.find(t=>(t.product_id||t.id)===e.product_id);if(t){if("modify"===A&&P){var n;let s=null===(n=P.order_details)||void 0===n?void 0:n.find(t=>t.product_id===e.product_id);if(s)return(t.available_stock||0)+s.quantity}return t.available_stock||0}return getAvailableStock(e.product)},addToCart=e=>{let t=e.product_id||e.id,n=S.find(e=>e.product_id===t);n?q(e=>e.map(e=>e.product_id===t?{...e,quantity:e.quantity+1}:e)):q(n=>[...n,{product_id:t,quantity:1,product:e}])},updateCartQuantity=(e,t)=>{t<=0?q(t=>t.filter(t=>t.product_id!==e)):q(n=>n.map(n=>n.product_id===e?{...n,quantity:t}:n))},removeFromCart=e=>{q(t=>t.filter(t=>t.product_id!==e))},calculateTotal=()=>S.reduce((e,t)=>e+(t.product.price||0)*t.quantity,0),calculateItemCount=()=>S.reduce((e,t)=>e+t.quantity,0),getProductsByCategory=()=>{let e=C.reduce((e,t)=>{let n=t.category||"Other";return e[n]||(e[n]=[]),e[n].push(t),e},{});return e},validateStockAvailability=async()=>{let e=[];if(null==k?void 0:k.brand_id)try{let{data:n,error:s}=await a.O.from("inventory_summary").select("*").eq("brand_id",k.brand_id);if(s)throw s;O(n||[]);let r=S.map(e=>{let t=null==n?void 0:n.find(t=>(t.product_id||t.id)===e.product_id);return t?{...e,product:t}:e});for(let s of(q(r),r)){let r=null==n?void 0:n.find(e=>(e.product_id||e.id)===s.product_id);if(r){let n=r.available_stock||0;if("modify"===A&&P){var t;let e=null===(t=P.order_details)||void 0===t?void 0:t.find(e=>e.product_id===s.product_id);e&&(n+=e.quantity)}s.quantity>n&&e.push("".concat(r.product_name||r.name,": Requested ").concat(s.quantity,", Available ").concat(n))}}}catch(t){for(let n of(console.error("Error fetching fresh product data:",t),S)){let t=getCartItemAvailableStock(n);n.quantity>t&&e.push("".concat(n.product.product_name||n.product.name,": Requested ").concat(n.quantity,", Available ").concat(t))}}return e},handleSubmitOrder=async()=>{if(!k||0===S.length){U("Please add items to your order.");return}let e=await validateStockAvailability();if(e.length>0){U("Insufficient stock for the following items:\n".concat(e.join("\n")));return}Z(!0),U("");try{for(let e of S){let{error:t}=await a.O.from("products").update({reserved:(e.product.reserved||0)+e.quantity,updated_at:new Date().toISOString()}).eq("id",e.product_id);if(t)throw t}let e=calculateTotal(),{data:t,error:n}=await a.O.from("customer_orders").insert([{location_id:k.id,brand_id:k.brand_id,customer_name:"".concat(k.name," Order"),status:"pending",total_amount:e}]).select();if(n)throw n;let s=S.map(e=>({order_id:t[0].id,product_id:e.product_id,quantity:e.quantity,unit_price:e.product.price||0})),{error:r}=await a.O.from("order_details").insert(s);if(r)throw r;R("Order submitted successfully!"),q([]),await checkPendingOrders(k.id),z("home"),G(!1)}catch(e){console.error("Error submitting order:",e),U("Failed to submit order. Please try again.")}finally{Z(!1)}},handleUpdateOrder=async()=>{if(!P||0===S.length)return;let e=await validateStockAvailability();if(e.length>0){U("Insufficient stock for the following items:\n".concat(e.join("\n")));return}Z(!0),U("");try{if(P.order_details)for(let e of P.order_details){let{error:t}=await a.O.from("products").update({reserved:(e.products.reserved||0)-e.quantity,updated_at:new Date().toISOString()}).eq("id",e.product_id);if(t)throw t}for(let e of(await a.O.from("order_details").delete().eq("order_id",P.id),S)){let{error:t}=await a.O.from("products").update({reserved:(e.product.reserved||0)+e.quantity,updated_at:new Date().toISOString()}).eq("id",e.product_id);if(t)throw t}let e=S.map(e=>({order_id:P.id,product_id:e.product_id,quantity:e.quantity,unit_price:e.product.price||0}));await a.O.from("order_details").insert(e);let t=calculateTotal();await a.O.from("customer_orders").update({total_amount:t}).eq("id",P.id),R("Order updated successfully!"),q([]),await checkPendingOrders(k.id),z("home"),G(!1)}catch(e){console.error("Error updating order:",e),U("Failed to update order. Please try again.")}finally{Z(!1)}},getTotalItems=e=>e.order_details.reduce((e,t)=>e+t.quantity,0),getTotalAmount=e=>e.order_details.reduce((e,t)=>e+t.unit_price*t.quantity,0),printReceipt=e=>{let t=window.open("","_blank");if(t){var n,s,r;t.document.write("\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Receipt - Order ".concat(e.id.slice(0,8),'</title>\n          <style>\n            \n            * { box-sizing: border-box; }\n            body { \n              font-family: Arial, sans-serif; \n              margin: 0; \n              padding: 10px; \n              background: white;\n              color: black;\n              line-height: 1.4;\n            }\n            \n            .receipt-container {\n              max-width: 100%;\n              width: 100%;\n              margin: 0;\n              background: white;\n              box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n              border-radius: 8px;\n              overflow: hidden;\n              display: flex;\n              flex-direction: column;\n              min-height: 100vh;\n            }\n            \n            .header { \n              text-align: center; \n              padding: 16px 20px;\n              background: white;\n              color: black;\n              border-bottom: 2px solid black;\n            }\n            \n            .company-name { \n              font-size: 23px; \n              font-weight: bold; \n              margin-bottom: 4px;\n              color: black;\n            }\n            \n            .receipt-title { \n              font-size: 15px; \n              font-weight: normal; \n              color: black;\n            }\n            \n            .order-info { \n              padding: 8px 12px; \n              background: white;\n              border-bottom: 1px solid black;\n            }\n            \n            .info-grid {\n              display: grid;\n              grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n              gap: 4px 12px;\n            }\n            \n            .info-item {\n              display: flex;\n              flex-direction: column;\n            }\n            \n            .info-label { \n              font-weight: normal; \n              color: #666;\n              font-size: 12px;\n              text-transform: uppercase;\n              margin-bottom: 1px;\n            }\n            \n            .info-value { \n              font-weight: normal; \n              color: black;\n              font-size: 13px;\n            }\n            \n            .status-badge {\n              display: inline-block;\n              padding: 2px 6px;\n              border: 1px solid black;\n              font-size: 11px;\n              font-weight: normal;\n              text-transform: uppercase;\n            }\n            \n            .status-pending { background: white; color: black; }\n            .status-approved { background: white; color: black; }\n            .status-released { background: black; color: white; }\n            .status-cancelled { background: white; color: black; }\n            \n            .items { \n              padding: 8px 12px;\n              flex: 1;\n            }\n            \n            .items-title {\n              font-size: 13px;\n              font-weight: bold;\n              margin-bottom: 6px;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .items-header {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              padding: 4px 0;\n              border-bottom: 1px solid black;\n              margin-bottom: 4px;\n            }\n            \n            .header-cell {\n              font-size: 11px;\n              font-weight: bold;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .header-checkbox { text-align: center; }\n            .header-item { text-align: left; }\n            .header-qty { text-align: center; }\n            .header-price { text-align: center; }\n            .header-total { text-align: right; }\n            \n            .item-checkbox {\n              text-align: center;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n            }\n            \n            .checkbox {\n              width: 14px;\n              height: 14px;\n              border: 1px solid black;\n              background: white;\n              cursor: pointer;\n            }\n            \n            .item-row {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              align-items: center;\n              padding: 4px 0;\n              border-bottom: 1px solid #ccc;\n            }\n            \n            .item-row:last-child {\n              border-bottom: none;\n            }\n            \n            .item-name {\n              font-weight: normal;\n              color: black;\n              margin-bottom: 1px;\n              font-size: 12px;\n            }\n            \n            .item-details {\n              font-size: 10px;\n              color: #666;\n            }\n            \n            .item-quantity {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-unit-price {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-price {\n              text-align: right;\n              font-weight: bold;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-section { \n              padding: 8px 12px;\n              background: white;\n              border-top: 1px solid black;\n            }\n            \n            .total-row {\n              display: flex;\n              justify-content: space-between;\n              align-items: center;\n              margin-bottom: 4px;\n            }\n            \n            .total-label {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-value {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .grand-total {\n              border-top: 1px solid black;\n              padding-top: 4px;\n              margin-top: 4px;\n            }\n            \n            .grand-total .total-label {\n              font-size: 13px;\n              font-weight: bold;\n            }\n            \n            .grand-total .total-value {\n              font-size: 14px;\n              font-weight: bold;\n              color: black;\n            }\n            \n            .footer { \n              text-align: center; \n              padding: 6px 12px;\n              background: black;\n              color: white;\n              margin-top: auto;\n            }\n            \n            .footer-text {\n              font-size: 11px;\n              margin-bottom: 2px;\n            }\n            \n            .footer-date {\n              font-size: 10px;\n            }\n            \n            .notes {\n              padding: 6px 12px;\n              background: white;\n              border: 1px solid black;\n              margin: 0 12px 8px;\n            }\n            \n            .notes-title {\n              font-weight: bold;\n              color: black;\n              margin-bottom: 2px;\n              font-size: 11px;\n            }\n            \n            .notes-text {\n              color: black;\n              font-size: 11px;\n            }\n            \n            @media print { \n              body { margin: 0; padding: 0; }\n              .receipt-container { box-shadow: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="receipt-container">\n            <div class="header">\n              <div class="company-name">').concat((null===(n=e.brand)||void 0===n?void 0:n.name)||(null==k?void 0:null===(s=k.brand)||void 0===s?void 0:s.name)||"GFC",'</div>\n              <div class="receipt-title">Order Receipt</div>\n            </div>\n            \n            <div class="order-info">\n              <div class="info-grid">\n                <div class="info-item">\n                  <span class="info-label">Order ID</span>\n                  <span class="info-value">').concat(e.id.slice(0,8),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Date (PST)</span>\n                  <span class="info-value">').concat((0,y.iI)(e.created_at,{dateStyle:"short"}),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Location</span>\n                  <span class="info-value">').concat((null===(r=e.location)||void 0===r?void 0:r.name)||(null==k?void 0:k.name)||"N/A",'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Customer</span>\n                  <span class="info-value">').concat(e.customer_name||"Walk-in",'</span>\n                </div>\n              </div>\n            </div>\n            \n            <div class="items">\n              <div class="items-header">\n                <div class="header-cell header-checkbox">✓</div>\n                <div class="header-cell header-item">Item</div>\n                <div class="header-cell header-qty">Quantity</div>\n                <div class="header-cell header-price">Unit Price</div>\n                <div class="header-cell header-total">Total</div>\n              </div>\n              ').concat(e.order_details.map(e=>{var t,n,s,r,a,l,i,d;return'\n                <div class="item-row">\n                  <div class="item-checkbox">\n                    <div class="checkbox"></div>\n                  </div>\n                  <div>\n                    <div class="item-name">'.concat((null===(t=e.product)||void 0===t?void 0:t.name)||(null===(n=e.products)||void 0===n?void 0:n.name),'</div>\n                    <div class="item-details">\n                      ').concat((null===(s=e.product)||void 0===s?void 0:s.sku)||(null===(r=e.products)||void 0===r?void 0:r.sku)?"SKU: ".concat((null===(a=e.product)||void 0===a?void 0:a.sku)||(null===(l=e.products)||void 0===l?void 0:l.sku)):"",'\n                    </div>\n                  </div>\n                  <div class="item-quantity">').concat(e.quantity," ").concat((null===(i=e.product)||void 0===i?void 0:i.unit)||(null===(d=e.products)||void 0===d?void 0:d.unit),'</div>\n                  <div class="item-unit-price">₱').concat(e.unit_price.toFixed(2),'</div>\n                  <div class="item-price">₱').concat((e.unit_price*e.quantity).toFixed(2),"</div>\n                </div>\n              ")}).join(""),"\n            </div>\n            \n            ").concat(e.notes?'\n              <div class="notes">\n                <div class="notes-title">Notes</div>\n                <div class="notes-text">'.concat(e.notes,"</div>\n              </div>\n            "):"",'\n            \n            <div class="total-section">\n              <div class="total-row">\n                <span class="total-label">Total Items</span>\n                <span class="total-value">').concat(getTotalItems(e),'</span>\n              </div>\n              <div class="total-row grand-total">\n                <span class="total-label">Total Amount</span>\n                <span class="total-value">₱').concat(getTotalAmount(e).toFixed(2),'</span>\n              </div>\n            </div>\n            \n            <div class="footer">\n              <div class="footer-text">Thank you for your order!</div>\n              <div class="footer-date">Generated on ').concat(new Date().toLocaleString(),"</div>\n            </div>\n          </div>\n        </body>\n        </html>\n      ")),t.document.close(),t.focus(),t.print(),t.close()}};return M?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-4 ".concat("green"===B?"bg-green-100":"red"===B?"bg-red-100":"yellow"===B?"bg-yellow-100":"bg-blue-100"),children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 ".concat("green"===B?"border-green-600":"red"===B?"border-red-600":"yellow"===B?"border-yellow-600":"border-blue-600")})}),(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Order System"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Please wait while we check your session..."})]})}):v?Q?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full mb-4 ".concat("green"===B?"bg-green-100":"red"===B?"bg-red-100":"yellow"===B?"bg-yellow-100":"bg-blue-100"),children:(0,s.jsx)(d,{className:"h-6 w-6 ".concat("green"===B?"text-green-600":"red"===B?"text-red-600":"yellow"===B?"text-yellow-600":"text-blue-600")})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Success!"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:Q}),(0,s.jsx)("button",{onClick:()=>{R(""),z("home")},className:"w-full px-4 py-3 text-white rounded-lg transition-colors ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:"Continue"})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[(0,s.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4 min-w-0 flex-1",children:[(0,s.jsx)(o,{className:"h-6 w-6 sm:h-8 sm:w-8 flex-shrink-0 ".concat("green"===B?"text-green-600":"red"===B?"text-red-600":"yellow"===B?"text-yellow-600":"text-blue-600")}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h1",{className:"text-lg sm:text-2xl font-bold text-gray-900 truncate",children:(null==k?void 0:null===(e=k.brand)||void 0===e?void 0:e.name)||"Order System"}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 flex items-center",children:[(0,s.jsx)(l.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:null==k?void 0:k.name})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 sm:space-x-2 flex-shrink-0",children:["home"!==A&&(0,s.jsxs)("button",{onClick:()=>z("home"),className:"flex items-center space-x-1 px-2 sm:px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors text-xs sm:text-sm",children:[(0,s.jsx)(c,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Home"})]}),(0,s.jsxs)("button",{onClick:()=>H(!0),className:"flex items-center space-x-1 px-2 sm:px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors text-xs sm:text-sm",children:[(0,s.jsx)(m,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Past Orders"})]}),(0,s.jsxs)("button",{onClick:clearSession,className:"flex items-center space-x-1 px-2 sm:px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors text-xs sm:text-sm",children:[(0,s.jsx)(x,{className:"h-3 w-3 sm:h-4 sm:w-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-8",children:["home"===A&&(0,s.jsxs)("div",{className:"space-y-6",children:[E&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-red-800 whitespace-pre-line",children:E})}),P?(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg mb-6 ".concat("approved"===P.status?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"),children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:"approved"===P.status?(0,s.jsx)(d,{className:"h-5 w-5 text-green-400"}):(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-yellow-400"})}),(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-lg font-medium ".concat("approved"===P.status?"text-green-800":"text-yellow-800"),children:"approved"===P.status?"Order Approved":"Pending Order"}),(0,s.jsx)("p",{className:"text-sm ".concat("approved"===P.status?"text-green-700":"text-yellow-700"),children:"approved"===P.status?"Your order has been approved and is being processed.":"Your order is pending approval. You can modify it if needed."})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["₱",(null===(t=P.total_amount)||void 0===t?void 0:t.toFixed(2))||"0.00"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Order #",P.id.slice(-8)]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:"Order Items"}),null===(n=P.order_details)||void 0===n?void 0:n.map(e=>(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:e.products.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["₱",e.unit_price.toFixed(2)," per ",e.products.unit]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-medium text-gray-900",children:[e.quantity," ",e.products.unit]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["₱",(e.quantity*e.unit_price).toFixed(2)]})]})]},e.id))]}),(0,s.jsxs)("div",{className:"mt-6 flex space-x-4",children:["pending"===P.status&&(0,s.jsxs)("button",{onClick:()=>{if((null==P?void 0:P.order_details)&&"pending"===P.status){let e=P.order_details.map(e=>({product_id:e.product_id,quantity:e.quantity,product:e.products}));q(e),z("modify")}},className:"flex items-center space-x-2 px-6 py-3 text-white rounded-lg transition-colors ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,s.jsx)(u,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Modify Order"})]}),"approved"===P.status&&(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"You have an approved order. Please wait for it to be processed before creating a new order."})})]})]}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-8 text-center",children:[(0,s.jsx)(p.Z,{className:"mx-auto h-16 w-16 mb-4 ".concat("green"===B?"text-green-400":"red"===B?"text-red-400":"yellow"===B?"text-yellow-400":"text-blue-400")}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Pending Orders"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"You can start a new order by clicking the button below."}),(0,s.jsxs)("button",{onClick:()=>{P||z("products")},className:"flex items-center space-x-2 px-6 py-3 text-white rounded-lg transition-colors mx-auto ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Start New Order"})]})]})]}),"products"===A&&!P&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2 min-w-0",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-3 sm:p-6",children:[(0,s.jsxs)("h2",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6 truncate",children:[null==k?void 0:null===(i=k.brand)||void 0===i?void 0:i.name," Products"]}),(0,s.jsx)("div",{className:"space-y-6",children:Object.entries(getProductsByCategory()).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 px-2 border-l-4 border-gray-300",children:t}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:n.map(e=>{var t;let n=e.product_id||e.id,r=S.some(e=>e.product_id===n),a=(null===(t=S.find(e=>e.product_id===n))||void 0===t?void 0:t.quantity)||0,l=getAvailableStock(e);return(0,s.jsxs)("div",{className:"border rounded-lg p-3 sm:p-4 hover:bg-gray-50 transition-colors min-w-0 ".concat(r?"border-blue-400 bg-blue-50":"border-gray-200"),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2 min-w-0",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 text-sm sm:text-base pr-2 truncate min-w-0 flex-1",children:e.product_name||e.name}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[a>0&&(0,s.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full",children:a}),(0,s.jsx)("span",{className:"text-xs sm:text-sm text-gray-500",children:e.unit})]})]}),(0,s.jsxs)("p",{className:"text-base sm:text-lg font-semibold text-green-600 mb-2 sm:mb-3",children:["₱",(e.price||0).toFixed(2)]}),(0,s.jsxs)("div",{className:"flex justify-between items-center min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs sm:text-sm font-medium ".concat(l>0?"text-green-600":"text-red-600"),children:["Stock: ",l]}),(0,s.jsx)("button",{onClick:()=>addToCart(e),disabled:0===l||r&&a>=l,className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-colors flex-shrink-0 ".concat(l>0&&(!r||a<l)?"green"===B?"bg-green-600 text-white hover:bg-green-700":"red"===B?"bg-red-600 text-white hover:bg-red-700":"yellow"===B?"bg-yellow-600 text-white hover:bg-yellow-700":"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:0===l?"Out":r&&a>=l?"Max":r?"More":"Add"})]})]},n)})})]},t)})})]})}),(0,s.jsx)("div",{className:"hidden lg:block lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-8",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Cart (",calculateItemCount()," items)"]}),0===S.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No items in cart"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-3 mb-6",children:S.map(e=>{let t=getCartItemAvailableStock(e),n=e.quantity>t;return(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg ".concat(n?"bg-red-50 border border-red-200":"bg-gray-50"),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.product.product_name||e.product.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["₱",(e.product.price||0).toFixed(2)," per ",e.product.unit]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(g,{className:"h-3 w-3"})}),(0,s.jsx)("span",{className:"text-sm w-8 text-center ".concat(n?"text-red-600 font-semibold":"text-gray-600"),children:e.quantity}),(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity+1),disabled:e.quantity>=t,className:"p-1 text-gray-400 hover:text-gray-600 disabled:text-gray-300",children:(0,s.jsx)(h.Z,{className:"h-3 w-3"})})]}),(0,s.jsxs)("p",{className:"text-xs mt-1 ".concat(n?"text-red-600 font-medium":"text-gray-500"),children:["Max: ",t," | Total: ₱",((e.product.price||0)*e.quantity).toFixed(2)]})]}),(0,s.jsx)("button",{onClick:()=>removeFromCart(e.product_id),className:"text-red-500 hover:text-red-700 ml-2",children:(0,s.jsx)(b.Z,{className:"h-4 w-4"})})]},e.product_id)})}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("span",{className:"font-medium",children:"Total:"}),(0,s.jsxs)("span",{className:"font-semibold text-green-600 text-lg",children:["₱",calculateTotal().toFixed(2)]})]}),(0,s.jsxs)("button",{onClick:()=>G(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 text-white rounded-lg transition-colors ${ currentTheme === 'green' ? 'bg-green-600 hover:bg-green-700' : currentTheme === 'red' ? 'bg-red-600 hover:bg-red-700' : currentTheme === 'yellow' ? 'bg-yellow-600 hover:bg-yellow-700' : 'bg-blue-600 hover:bg-blue-700' }",children:[(0,s.jsx)(p.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"View Cart"})]})]})]})]})})]}),"products"===A&&!P&&(0,s.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-40",children:(0,s.jsxs)("div",{className:"px-2 py-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2 min-w-0",children:[(0,s.jsxs)("span",{className:"font-medium text-sm truncate",children:["Items: ",calculateItemCount()]}),(0,s.jsxs)("span",{className:"font-bold text-base text-green-600 flex-shrink-0 ml-2",children:["₱",calculateTotal().toFixed(2)]})]}),(0,s.jsxs)("button",{onClick:()=>G(!0),disabled:P,className:"w-full flex items-center justify-center space-x-1 px-2 py-2 rounded-lg transition-colors text-xs sm:text-sm min-w-0 disabled:opacity-50 disabled:cursor-not-allowed ".concat("green"===B?"bg-green-600 hover:bg-green-700 text-white":"red"===B?"bg-red-600 hover:bg-red-700 text-white":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:[(0,s.jsx)(p.Z,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:"View Cart"})]})]})}),"products"===A&&!P&&(0,s.jsx)("div",{className:"lg:hidden pb-20"}),"modify"===A&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2 min-w-0",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-3 sm:p-6",children:[(0,s.jsx)("h2",{className:"text-lg sm:text-xl font-semibold mb-4 sm:mb-6 truncate",children:"Modify Order - Draft Mode"}),(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 sm:p-4 mb-4 sm:mb-6",children:(0,s.jsxs)("p",{className:"text-yellow-800 text-xs sm:text-sm",children:[(0,s.jsx)("strong",{children:"Note:"}),' Changes are saved as draft. Click "Update Order" to save changes permanently.']})}),(0,s.jsx)("div",{className:"space-y-6",children:Object.entries(getProductsByCategory()).map(e=>{let[t,n]=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3 px-2 border-l-4 border-gray-300",children:t}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:n.map(e=>{var t;let n=e.product_id||e.id,r=S.some(e=>e.product_id===n),a=(null===(t=S.find(e=>e.product_id===n))||void 0===t?void 0:t.quantity)||0,l=getAvailableStock(e);return(0,s.jsxs)("div",{className:"border rounded-lg p-3 sm:p-4 hover:bg-gray-50 transition-colors min-w-0 ".concat(r?"border-blue-400 bg-blue-50":"border-gray-200"),children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-2 min-w-0",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 text-sm sm:text-base pr-2 truncate min-w-0 flex-1",children:e.product_name||e.name}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[a>0&&(0,s.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2 py-1 rounded-full",children:a}),(0,s.jsx)("span",{className:"text-xs sm:text-sm text-gray-500",children:e.unit})]})]}),(0,s.jsxs)("p",{className:"text-base sm:text-lg font-semibold text-green-600 mb-2 sm:mb-3",children:["₱",(e.price||0).toFixed(2)]}),(0,s.jsxs)("div",{className:"flex justify-between items-center min-w-0",children:[(0,s.jsxs)("span",{className:"text-xs sm:text-sm font-medium ".concat(l>0?"text-green-600":"text-red-600"),children:["Stock: ",l]}),(0,s.jsx)("button",{onClick:()=>addToCart(e),disabled:0===l||r&&a>=l,className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-colors flex-shrink-0 ".concat(l>0&&(!r||a<l)?"green"===B?"bg-green-600 text-white hover:bg-green-700":"red"===B?"bg-red-600 text-white hover:bg-red-700":"yellow"===B?"bg-yellow-600 text-white hover:bg-yellow-700":"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-400 text-gray-200 cursor-not-allowed"),children:0===l?"Out":r&&a>=l?"Max":r?"More":"Add"})]})]},n)})})]},t)})})]})}),(0,s.jsx)("div",{className:"hidden lg:block lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-8",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Order Draft (",calculateItemCount()," items)"]}),0===S.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No items in draft"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-3 mb-6",children:S.map(e=>{let t=getCartItemAvailableStock(e),n=e.quantity>t;return(0,s.jsxs)("div",{className:"flex justify-between items-center p-3 rounded-lg ".concat(n?"bg-red-50 border border-red-200":"bg-gray-50"),children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:e.product.product_name||e.product.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["₱",(e.product.price||0).toFixed(2)," per ",e.product.unit]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(g,{className:"h-3 w-3"})}),(0,s.jsx)("span",{className:"text-sm w-8 text-center ".concat(n?"text-red-600 font-semibold":"text-gray-600"),children:e.quantity}),(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity+1),disabled:e.quantity>=t,className:"p-1 text-gray-400 hover:text-gray-600 disabled:text-gray-300",children:(0,s.jsx)(h.Z,{className:"h-3 w-3"})})]}),(0,s.jsxs)("p",{className:"text-xs mt-1 ".concat(n?"text-red-600 font-medium":"text-gray-500"),children:["Max: ",t," | Total: ₱",((e.product.price||0)*e.quantity).toFixed(2)]})]}),(0,s.jsx)("button",{onClick:()=>removeFromCart(e.product_id),className:"text-red-500 hover:text-red-700 ml-2",children:(0,s.jsx)(b.Z,{className:"h-4 w-4"})})]},e.product_id)})}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("span",{className:"font-medium",children:"Total:"}),(0,s.jsxs)("span",{className:"font-semibold text-green-600 text-lg",children:["₱",calculateTotal().toFixed(2)]})]}),(0,s.jsxs)("button",{onClick:()=>G(!0),className:"w-full flex items-center justify-center space-x-2 px-4 py-3 text-white rounded-lg transition-colors ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,s.jsx)(u,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"View Draft & Update"})]})]})]})]})})]}),"modify"===A&&(0,s.jsx)("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-40",children:(0,s.jsxs)("div",{className:"px-2 py-2",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2 min-w-0",children:[(0,s.jsxs)("span",{className:"font-medium text-sm truncate",children:["Draft: ",calculateItemCount()," items"]}),(0,s.jsxs)("span",{className:"font-bold text-base text-green-600 flex-shrink-0 ml-2",children:["₱",calculateTotal().toFixed(2)]})]}),(0,s.jsxs)("button",{onClick:()=>G(!0),className:"w-full flex items-center justify-center space-x-1 px-2 py-2 rounded-lg transition-colors text-xs sm:text-sm min-w-0 ".concat("green"===B?"bg-green-600 hover:bg-green-700 text-white":"red"===B?"bg-red-600 hover:bg-red-700 text-white":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:[(0,s.jsx)(u,{className:"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:"View Draft & Update"})]})]})}),"modify"===A&&(0,s.jsx)("div",{className:"lg:hidden pb-20"})]}),V&&(!P||"modify"===A)&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-t-lg sm:rounded-lg w-full max-w-md max-h-[80vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b min-w-0",children:[(0,s.jsxs)("h2",{className:"text-base sm:text-lg font-semibold truncate min-w-0 flex-1",children:["modify"===A?"Order Draft":"Your Cart"," (",calculateItemCount()," items)"]}),(0,s.jsx)("button",{onClick:()=>G(!1),className:"p-2 text-gray-400 hover:text-gray-600 flex-shrink-0",children:(0,s.jsx)(b.Z,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),(0,s.jsx)("div",{className:"p-3 sm:p-4 max-h-96 overflow-y-auto",children:0===S.length?(0,s.jsxs)("p",{className:"text-gray-500 text-center py-8",children:["No items in ","modify"===A?"draft":"cart"]}):(0,s.jsx)("div",{className:"space-y-3",children:S.map(e=>{let t=getCartItemAvailableStock(e),n=e.quantity>t;return(0,s.jsxs)("div",{className:"flex justify-between items-center p-2 sm:p-3 rounded-lg min-w-0 ".concat(n?"bg-red-50 border border-red-200":"bg-gray-50"),children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.product.product_name||e.product.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["₱",(e.product.price||0).toFixed(2)," per ",e.product.unit]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity-1),className:"p-1 text-gray-400 hover:text-gray-600 flex-shrink-0",children:(0,s.jsx)(g,{className:"h-3 w-3"})}),(0,s.jsx)("span",{className:"text-sm w-6 sm:w-8 text-center ".concat(n?"text-red-600 font-semibold":"text-gray-600"),children:e.quantity}),(0,s.jsx)("button",{onClick:()=>updateCartQuantity(e.product_id,e.quantity+1),disabled:e.quantity>=t,className:"p-1 text-gray-400 hover:text-gray-600 disabled:text-gray-300 flex-shrink-0",children:(0,s.jsx)(h.Z,{className:"h-3 w-3"})})]}),(0,s.jsxs)("p",{className:"text-xs mt-1 ".concat(n?"text-red-600 font-medium":"text-gray-500"),children:["Max: ",t," | Total: ₱",((e.product.price||0)*e.quantity).toFixed(2)]})]}),(0,s.jsx)("button",{onClick:()=>removeFromCart(e.product_id),className:"text-red-500 hover:text-red-700 ml-2 flex-shrink-0",children:(0,s.jsx)(b.Z,{className:"h-3 w-3 sm:h-4 sm:w-4"})})]},e.product_id)})})}),S.length>0&&(0,s.jsxs)("div",{className:"p-3 sm:p-4 border-t bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3 sm:mb-4 min-w-0",children:[(0,s.jsx)("span",{className:"font-medium text-sm sm:text-base",children:"Total:"}),(0,s.jsxs)("span",{className:"font-semibold text-green-600 text-base sm:text-lg flex-shrink-0 ml-2",children:["₱",calculateTotal().toFixed(2)]})]}),E&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 sm:p-3 mb-3 sm:mb-4",children:(0,s.jsx)("p",{className:"text-red-800 text-xs sm:text-sm whitespace-pre-line",children:E})}),(0,s.jsx)("div",{className:"space-y-2",children:"modify"===A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("button",{onClick:handleUpdateOrder,disabled:D||0===S.length,className:"w-full flex items-center justify-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-2 sm:py-3 text-white rounded-lg disabled:opacity-50 transition-colors text-sm sm:text-base ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[D?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 sm:h-5 sm:w-5 border-b-2 border-white flex-shrink-0"}):(0,s.jsx)(u,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:D?"Updating...":"Update Order"})]}),(0,s.jsx)("button",{onClick:()=>{q([]),z("home"),G(!1)},className:"w-full px-3 sm:px-4 py-2 sm:py-3 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors text-sm sm:text-base",children:"Cancel Changes"})]}):(0,s.jsxs)("button",{onClick:handleSubmitOrder,disabled:D||0===S.length,className:"w-full flex items-center justify-center space-x-1 sm:space-x-2 px-3 sm:px-4 py-2 sm:py-3 text-white rounded-lg disabled:opacity-50 transition-colors text-sm sm:text-base ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[D?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 sm:h-5 sm:w-5 border-b-2 border-white flex-shrink-0"}):(0,s.jsx)(p.Z,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:D?"Submitting...":"Submit Order"})]})})]})]})}),Y&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Past Orders"}),(0,s.jsx)("button",{onClick:()=>H(!1),className:"p-2 text-gray-400 hover:text-gray-600",children:(0,s.jsx)(b.Z,{className:"h-5 w-5"})})]}),(0,s.jsx)("div",{className:"p-6 max-h-96 overflow-y-auto",children:0===F.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:"No past orders found"}):(0,s.jsx)("div",{className:"space-y-4",children:F.map(e=>(0,s.jsxs)("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-medium text-gray-900",children:["Order #",e.id.slice(-8)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[new Date(e.created_at).toLocaleDateString()," at ",new Date(e.created_at).toLocaleTimeString()]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("released"===e.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),(0,s.jsxs)("p",{className:"text-lg font-semibold text-gray-900 mt-1",children:["₱",e.total_amount.toFixed(2)]})]})]}),(0,s.jsx)("div",{className:"space-y-2",children:e.order_details.map(e=>(0,s.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,s.jsx)("span",{className:"text-gray-900",children:e.products.name}),(0,s.jsxs)("span",{className:"text-gray-600",children:[e.quantity," \xd7 ₱",e.unit_price.toFixed(2)," = ₱",(e.quantity*e.unit_price).toFixed(2)]})]},e.id))}),(0,s.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200",children:(0,s.jsxs)("button",{onClick:()=>printReceipt(e),className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("green"===B?"bg-green-100 text-green-700 hover:bg-green-200":"red"===B?"bg-red-100 text-red-700 hover:bg-red-200":"yellow"===B?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:[(0,s.jsx)(f.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Print Receipt"})]})})]},e.id))})})]})}),(0,s.jsx)("div",{className:"bg-white border-t py-4 mt-8",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4",children:(0,s.jsx)("p",{className:"text-center text-xs text-gray-500",children:"\xa9 Gilnaks Food Corporation"})})})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full mb-4 ".concat("green"===B?"bg-green-100":"red"===B?"bg-red-100":"yellow"===B?"bg-yellow-100":"bg-blue-100"),children:(0,s.jsx)(l.Z,{className:"h-6 w-6 ".concat("green"===B?"text-green-600":"red"===B?"text-red-600":"yellow"===B?"text-yellow-600":"text-blue-600")})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"GFC Order Portal"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Enter your location passcode to continue"})]}),(0,s.jsxs)("form",{onSubmit:handleLocationAuth,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"passcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Passcode"}),(0,s.jsx)("input",{type:"text",id:"passcode",value:j,onChange:e=>N(e.target.value.replace(/\D/g,"").slice(0,6)),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 text-center text-lg tracking-wider ".concat("green"===B?"focus:ring-green-500 focus:border-green-500":"red"===B?"focus:ring-red-500 focus:border-red-500":"yellow"===B?"focus:ring-yellow-500 focus:border-yellow-500":"focus:ring-blue-500 focus:border-blue-500"),placeholder:"Enter 6-digit code",maxLength:6,required:!0})]}),E&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,s.jsx)("p",{className:"text-red-800 text-sm whitespace-pre-line",children:E})}),(0,s.jsxs)("button",{type:"submit",disabled:D,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 text-white rounded-lg transition-colors font-medium disabled:opacity-50 ".concat("green"===B?"bg-green-600 hover:bg-green-700":"red"===B?"bg-red-600 hover:bg-red-700":"yellow"===B?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[D?(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}):(0,s.jsx)(l.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:D?"Signing in...":"Continue to Order"})]})]})]})})}},2899:function(e,t,n){"use strict";n.d(t,{O:function(){return r}});var s=n(3082);let r=(0,s.createClientComponentClient)()},8939:function(e,t,n){"use strict";n.d(t,{iI:function(){return formatPhilippinesDateTime},jA:function(){return toPhilippinesDateString},sn:function(){return getPhilippinesDate}});let s="Asia/Manila";function toPhilippinesTime(e){let t=new Date(e);return new Date(t.toLocaleString("en-US",{timeZone:s}))}function getPhilippinesDate(){let e=new Date;return e.toLocaleDateString("en-CA",{timeZone:s})}function toPhilippinesDateString(e){let t=toPhilippinesTime(e);return t.toLocaleDateString("en-CA")}function formatPhilippinesDateTime(e,t){let n=toPhilippinesTime(e);return n.toLocaleString("en-US",{timeZone:s,...t})}}},function(e){e.O(0,[587,971,472,744],function(){return e(e.s=9033)}),_N_E=e.O()}]);