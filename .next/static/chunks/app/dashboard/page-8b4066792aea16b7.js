(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{4322:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,a.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},4264:function(e,t,r){Promise.resolve().then(r.bind(r,5270))},5270:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return DashboardPage}});var a=r(7437),n=r(2265),s=r(2899);function BrandSelector(e){let{onBrandChange:t}=e,[r,l]=(0,n.useState)([]),[o,i]=(0,n.useState)(null),[d,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{fetchBrands()},[]);let fetchBrands=async()=>{try{console.log("Fetching brands from Supabase...");let{data:e,error:r}=await s.O.from("brands").select("*").order("name");if(console.log("Supabase response:",{data:e,error:r}),r){console.error("Error fetching brands:",r);return}e&&(console.log("Brands loaded:",e),l(e),e.length>0&&(i(e[0]),t(e[0])))}catch(e){console.error("Error fetching brands:",e)}finally{c(!1)}},handleBrandChange=e=>{let a=r.find(t=>t.id===e);a&&(i(a),t(a))};return d?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Loading brands..."})]}):(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("label",{htmlFor:"brand-select",className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"Brand:"}),(0,a.jsx)("select",{id:"brand-select",value:(null==o?void 0:o.id)||"",onChange:e=>handleBrandChange(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900 text-sm min-w-[140px]",children:r.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))})]})}var l=r(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,l.Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);var i=r(9883),d=r(2549);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,l.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),x=(0,l.Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),m=(0,l.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var u=r(8939);function ProductManager(e){let{selectedBrand:t,theme:r="blue"}=e,[l,p]=(0,n.useState)([]),[h,g]=(0,n.useState)(!1),[b,f]=(0,n.useState)(!1),[y,v]=(0,n.useState)(null),[w,j]=(0,n.useState)({name:"",sku:"",category:"",unit:"pcs",price:0,initial_stock:0,production:0,released:0,reserved:0}),[N,k]=(0,n.useState)([]),[_,S]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t&&fetchProducts()},[t]),(0,n.useEffect)(()=>{if(!t)return;let e=s.O.channel("products-changes").on("postgres_changes",{event:"*",schema:"public",table:"products",filter:"brand_id=eq.".concat(t.id)},e=>{console.log("Products realtime update:",e),y?console.log("Skipping realtime refetch - currently editing product"):fetchProducts()}).subscribe();return()=>{s.O.removeChannel(e)}},[t,y]),(0,n.useEffect)(()=>{let e=Array.from(new Set(l.map(e=>e.category).filter(e=>e&&""!==e.trim()))).sort();k(e)},[l]),(0,n.useEffect)(()=>{let handleClickOutside=e=>{let t=e.target;_&&!t.closest(".category-dropdown")&&S(!1)};if(_)return document.addEventListener("mousedown",handleClickOutside),()=>document.removeEventListener("mousedown",handleClickOutside)},[_]);let getBrandPrefix=e=>{switch(e){case"gelatofilipino":return"GF-";case"mychoice":return"MC-";case"mang-sorbetes":return"MS-";default:return"PR-"}},generateNextSKU=async e=>{if(!t)return"";try{let{data:r,error:a}=await s.O.from("products").select("sku").eq("brand_id",e).not("sku","is",null);if(a)return console.error("Error fetching products for SKU generation:",a),getBrandPrefix(t.slug)+"001";let n=getBrandPrefix(t.slug),l=0;r&&r.length>0&&r.forEach(e=>{if(e.sku&&e.sku.startsWith(n)){let t=e.sku.substring(n.length),r=parseInt(t);!isNaN(r)&&r>l&&(l=r)}});let o=l+1;return n+o.toString().padStart(3,"0")}catch(e){return console.error("Error generating SKU:",e),getBrandPrefix(t.slug)+"001"}},fetchProducts=async()=>{if(t){g(!0);try{let{data:e,error:r}=await s.O.from("inventory_summary").select("*").eq("brand_id",t.id).order("product_name");if(r){console.error("Error fetching products:",r);return}e&&p(e)}catch(e){console.error("Error fetching products:",e)}finally{g(!1)}}},handleAddProduct=async e=>{if(e.preventDefault(),t)try{let{data:e,error:r}=await s.O.from("products").insert([{brand_id:t.id,name:w.name,sku:w.sku||null,category:w.category||null,unit:w.unit,price:w.price,initial_stock:w.initial_stock,production:w.production,released:w.released,reserved:w.reserved}]).select();if(r){console.error("Error adding product:",r),alert("Error adding product: "+r.message);return}e&&(await fetchProducts(),j({name:"",sku:"",category:"",unit:"pcs",price:0,initial_stock:0,production:0,released:0,reserved:0}),f(!1))}catch(e){console.error("Error adding product:",e),alert("Error adding product")}},handleUpdateProduct=async e=>{try{let{data:t,error:r}=await s.O.from("products").update({name:e.name,sku:e.sku,category:e.category,unit:e.unit,price:e.price,initial_stock:e.initial_stock,production:e.production,released:e.released,reserved:e.reserved}).eq("id",e.id).select();if(r){console.error("Error updating product:",r),alert("Error updating product: "+r.message);return}t&&(await fetchProducts(),v(null))}catch(e){console.error("Error updating product:",e),alert("Error updating product")}},handleDeleteProduct=async e=>{if(confirm("Are you sure you want to delete this product?"))try{let{error:t}=await s.O.from("products").delete().eq("id",e);if(t){console.error("Error deleting product:",t),alert("Error deleting product: "+t.message);return}console.log("Product deleted successfully"),p(l.filter(t=>(t.product_id||t.id)!==e)),setTimeout(async()=>{console.log("Refetching products to ensure consistency"),await fetchProducts()},500)}catch(e){console.error("Error deleting product:",e),alert("Error deleting product")}},handleFinalizeStock=async()=>{if(t&&confirm("Are you sure you want to finalize the stock? This will move final stock to initial stock and clear production/released quantities for all products."))try{let{data:e,error:r}=await s.O.from("products").select("*").eq("brand_id",t.id);if(r){console.error("Error fetching products:",r),alert("Error fetching products for finalization");return}if(!e||0===e.length){alert("No products found to finalize");return}let{data:a,error:n}=await s.O.from("daily_stock_summaries").insert({brand_id:t.id,date:(0,u.sn)(),total_production:e.reduce((e,t)=>e+(t.production||0),0),total_released:e.reduce((e,t)=>e+(t.released||0),0),total_final_stock:e.reduce((e,t)=>e+(t.initial_stock||0)+(t.production||0)-(t.released||0),0)}).select().single();if(n){console.error("Error creating daily summary:",n),alert("Error creating daily summary");return}for(let t of e){let e=(t.initial_stock||0)+(t.production||0)-(t.released||0),{error:r}=await s.O.from("products").update({initial_stock:e,production:0,released:0,updated_at:new Date().toISOString()}).eq("id",t.id);if(r){console.error("Error updating product ".concat(t.name,":"),r),alert("Error updating product ".concat(t.name));return}}alert("Stock finalized successfully! All products have been updated for the next day."),await fetchProducts()}catch(e){console.error("Error finalizing stock:",e),alert("Error finalizing stock")}};return t?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["Products for ",t.name]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:handleFinalizeStock,className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("bg-orange-600 hover:bg-orange-700"),children:[(0,a.jsx)(o,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Finalize Stock"})]}),(0,a.jsxs)("button",{onClick:async()=>{let e=await generateNextSKU(t.id);j({...w,sku:e}),f(!0)},className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("green"===r?"bg-green-600 hover:bg-green-700":"red"===r?"bg-red-600 hover:bg-red-700":"yellow"===r?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Product"})]})]})]}),b&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Product"}),(0,a.jsx)("button",{onClick:()=>{f(!1),j({name:"",sku:"",category:"",unit:"pcs",price:0,initial_stock:0,production:0,released:0,reserved:0})},className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:handleAddProduct,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:w.name,onChange:e=>j({...w,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter product name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU (Auto-generated)"}),(0,a.jsx)("input",{type:"text",value:w.sku,onChange:e=>j({...w,sku:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50",placeholder:"Auto-generated SKU"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["SKU format: ",getBrandPrefix(t.slug),"XXX (e.g., ",getBrandPrefix(t.slug),"001)"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,a.jsxs)("div",{className:"relative category-dropdown",children:[(0,a.jsx)("input",{type:"text",value:w.category,onChange:e=>{j({...w,category:e.target.value}),S(!0)},onFocus:()=>S(!0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter or select category"}),_&&N.length>0&&(0,a.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:N.map(e=>(0,a.jsx)("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),j({...w,category:e}),S(!1)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},className:"w-full text-left px-3 py-2 hover:bg-gray-100 text-sm",children:e},e))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Stock"}),(0,a.jsx)("input",{type:"number",min:"0",value:w.initial_stock,onChange:e=>j({...w,initial_stock:parseInt(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit"}),(0,a.jsxs)("select",{value:w.unit,onChange:e=>j({...w,unit:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"pans",children:"Pans"}),(0,a.jsx)("option",{value:"pcs",children:"Pieces"}),(0,a.jsx)("option",{value:"gallons",children:"Gallons"}),(0,a.jsx)("option",{value:"liters",children:"Liters"}),(0,a.jsx)("option",{value:"kg",children:"Kilograms"}),(0,a.jsx)("option",{value:"boxes",children:"Boxes"}),(0,a.jsx)("option",{value:"bags",children:"Bags"}),(0,a.jsx)("option",{value:"g",children:"Grams"}),(0,a.jsx)("option",{value:"bottles",children:"Bottles"}),(0,a.jsx)("option",{value:"packs",children:"Packs"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (₱)"}),(0,a.jsx)("input",{type:"number",min:"0",step:"0.01",value:w.price,onChange:e=>j({...w,price:parseFloat(e.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{f(!1),j({name:"",sku:"",category:"",unit:"pcs",price:0,initial_stock:0,production:0,released:0,reserved:0})},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("green"===r?"bg-green-600 hover:bg-green-700":"red"===r?"bg-red-600 hover:bg-red-700":"yellow"===r?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Save Product"})]})]})]})]})}),h?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading products..."})]}):0===l.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsxs)("p",{children:["No products found for ",t.name]}),(0,a.jsx)("p",{className:"text-sm",children:'Click "Add Product" to create your first product'})]}):(0,a.jsx)("div",{className:"space-y-6",children:(e=>{let t=e.reduce((e,t)=>{let r=t.category||"Uncategorized";return e[r]||(e[r]=[]),e[r].push(t),e},{}),r=Object.keys(t).sort((e,t)=>"Uncategorized"===e?1:"Uncategorized"===t?-1:e.localeCompare(t));return r.map(e=>({category:e,products:t[e]}))})(l).map(e=>{let{category:t,products:n}=e;return(0,a.jsxs)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-200 ease-in-out",children:[(0,a.jsx)("div",{className:"bg-gray-50 px-6 py-3 border-b hover:bg-gray-100 transition-colors duration-200 ease-in-out",children:(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:[t," (",n.length," ",1===n.length?"product":"products",")"]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Product Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"SKU"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Unit"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Price"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Initial Stock"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Prod"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Rel"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Final Stock"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Res"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Available"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-blue-100",children:[(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"text",value:y.name,onChange:e=>v({...y,name:e.target.value}),className:"w-full max-w-44 px-2 py-1 border border-gray-300 rounded text-sm"}):e.product_name||e.name}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"text",value:y.sku||"",onChange:e=>v({...y,sku:e.target.value}),className:"w-full max-w-28 px-2 py-1 border border-gray-300 rounded text-sm"}):e.sku||"-"}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsxs)("select",{value:y.unit,onChange:e=>v({...y,unit:e.target.value}),className:"w-full max-w-20 px-2 py-1 border border-gray-300 rounded text-sm",children:[(0,a.jsx)("option",{value:"pans",children:"Pans"}),(0,a.jsx)("option",{value:"pcs",children:"Pieces"}),(0,a.jsx)("option",{value:"gallons",children:"Gallons"}),(0,a.jsx)("option",{value:"liters",children:"Liters"}),(0,a.jsx)("option",{value:"kg",children:"Kilograms"}),(0,a.jsx)("option",{value:"boxes",children:"Boxes"}),(0,a.jsx)("option",{value:"bags",children:"Bags"}),(0,a.jsx)("option",{value:"g",children:"Grams"}),(0,a.jsx)("option",{value:"bottles",children:"Bottles"}),(0,a.jsx)("option",{value:"packs",children:"Packs"})]}):e.unit}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-green-600",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"number",min:"0",step:"0.01",value:y.price||0,onChange:e=>v({...y,price:parseFloat(e.target.value)||0}),className:"w-full max-w-20 px-2 py-1 border border-gray-300 rounded text-sm text-center [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]"}):"₱".concat((e.price||0).toFixed(2))}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"number",min:"0",value:y.initial_stock||0,onChange:e=>v({...y,initial_stock:parseInt(e.target.value)||0}),className:"w-full max-w-16 px-2 py-1 border border-gray-300 rounded text-sm text-center [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]"}):e.initial_stock||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"number",min:"0",value:y.production||0,onChange:e=>v({...y,production:parseInt(e.target.value)||0}),className:"w-full max-w-16 px-2 py-1 border border-gray-300 rounded text-sm text-center [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]"}):e.production||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"number",min:"0",value:y.released||0,onChange:e=>v({...y,released:parseInt(e.target.value)||0}),className:"w-full max-w-16 px-2 py-1 border border-gray-300 rounded text-sm text-center [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]"}):e.released||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-semibold text-purple-600",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(y.initial_stock||0)+(y.production||0)-(y.released||0):e.final_stock||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsx)("input",{type:"number",min:"0",value:y.reserved||0,onChange:e=>v({...y,reserved:parseInt(e.target.value)||0}),className:"w-full max-w-16 px-2 py-1 border border-gray-300 rounded text-sm text-center [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [-moz-appearance:textfield]"}):e.reserved||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-semibold text-emerald-600",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(y.initial_stock||0)+(y.production||0)-(y.released||0)-(y.reserved||0):e.available_stock||0}),(0,a.jsx)("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex space-x-2",children:(null==y?void 0:y.id)===(e.product_id||e.id)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>handleUpdateProduct(y),className:"p-1 rounded ".concat("green"===r?"text-green-600 hover:text-green-900 hover:bg-green-100":"red"===r?"text-red-600 hover:text-red-900 hover:bg-red-100":"yellow"===r?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-100":"text-blue-600 hover:text-blue-900 hover:bg-blue-100"),title:"Save",children:(0,a.jsx)(c,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>v(null),className:"p-1 rounded text-gray-600 hover:text-gray-900 hover:bg-gray-200",title:"Cancel",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>v({...e,id:e.product_id||e.id,name:e.product_name||e.name}),className:"p-1 rounded ".concat("green"===r?"text-green-600 hover:text-green-900 hover:bg-green-100":"red"===r?"text-red-600 hover:text-red-900 hover:bg-red-100":"yellow"===r?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-100":"text-blue-600 hover:text-blue-900 hover:bg-blue-100"),title:"Edit",children:(0,a.jsx)(x,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>handleDeleteProduct(e.product_id||e.id),className:"p-1 rounded text-red-600 hover:text-red-900 hover:bg-red-100",title:"Delete",children:(0,a.jsx)(m,{className:"h-4 w-4"})})]})})})]},e.product_id||e.id))})]})})]},t)})})]}):(0,a.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,a.jsx)("p",{children:"Please select a brand to manage products"})})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let p=(0,l.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),h=(0,l.Z)("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),g=(0,l.Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var b=r(3505);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let f=(0,l.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var y=r(8501);function OrderManager(e){var t,r,l;let{selectedBrand:i,onOrderUpdate:d,theme:c="blue"}=e,[x,v]=(0,n.useState)([]),[w,j]=(0,n.useState)(!1),[N,k]=(0,n.useState)(null),[_,S]=(0,n.useState)(null),[C,E]=(0,n.useState)("all");(0,n.useEffect)(()=>{fetchOrders()},[C,i]),(0,n.useEffect)(()=>{if(!i)return;let e=s.O.channel("customer-orders-changes").on("postgres_changes",{event:"*",schema:"public",table:"customer_orders",filter:"brand_id=eq.".concat(i.id)},e=>{console.log("Customer orders realtime update:",e),N?console.log("Skipping realtime refetch - currently updating order"):fetchOrders()}).subscribe();return()=>{s.O.removeChannel(e)}},[i,N]);let fetchOrders=async()=>{j(!0);try{let e=s.O.from("customer_orders").select("\n          *,\n          location:locations(*),\n          brand:brands(*),\n          order_details(\n            *,\n            product:products(id, name, sku, unit)\n          )\n        ").order("created_at",{ascending:!1});"all"!==C&&(e=e.eq("status",C)),i&&(e=e.eq("brand_id",i.id));let{data:t,error:r}=await e;if(r){console.error("Error fetching orders:",r);return}t&&v(t)}catch(e){console.error("Error fetching orders:",e)}finally{j(!1)}},updateOrderStatus=async(e,t)=>{if(N===e){console.log("Order update already in progress for:",e);return}k(e);try{if("released"===t){let{data:t,error:r}=await s.O.from("order_details").select("product_id, quantity").eq("order_id",e);if(r){console.error("Error fetching order details:",r),alert("Failed to fetch order details");return}for(let e of t||[]){let{data:t,error:r}=await s.O.from("products").select("reserved, released").eq("id",e.product_id).single();if(r){console.error("Error fetching product data:",r),alert("Failed to fetch product data");return}let a=Math.max(0,((null==t?void 0:t.reserved)||0)-e.quantity),n=((null==t?void 0:t.released)||0)+e.quantity,{error:l}=await s.O.from("products").update({reserved:a,released:n,updated_at:new Date().toISOString()}).eq("id",e.product_id);if(l){console.error("Error updating product quantities:",l),alert("Failed to update product quantities");return}}}if("cancelled"===t){let{data:t,error:r}=await s.O.from("order_details").select("product_id, quantity").eq("order_id",e);if(r){console.error("Error fetching order details:",r),alert("Failed to fetch order details");return}for(let e of t||[]){let{data:t,error:r}=await s.O.from("products").select("reserved").eq("id",e.product_id).single();if(r){console.error("Error fetching product data:",r),alert("Failed to fetch product data");return}let a=Math.max(0,((null==t?void 0:t.reserved)||0)-e.quantity),{error:n}=await s.O.from("products").update({reserved:a,updated_at:new Date().toISOString()}).eq("id",e.product_id);if(n){console.error("Error updating product quantities:",n),alert("Failed to update product quantities");return}}}let{error:r}=await s.O.from("customer_orders").update({status:t,updated_at:new Date().toISOString()}).eq("id",e);if(r){console.error("Error updating order status:",r),alert("Failed to update order status");return}fetchOrders(),d&&d()}catch(e){console.error("Error updating order status:",e),alert("Failed to update order status")}finally{k(null)}},handleDeleteOrder=async e=>{if(confirm("Are you sure you want to delete this order? This action cannot be undone."))try{k(e);let{error:t}=await s.O.from("order_details").delete().eq("order_id",e);if(t){console.error("Error deleting order details:",t),alert("Failed to delete order details");return}let{error:r}=await s.O.from("customer_orders").delete().eq("id",e);if(r){console.error("Error deleting order:",r),alert("Failed to delete order");return}fetchOrders(),d&&d()}catch(e){console.error("Error deleting order:",e),alert("Failed to delete order")}finally{k(null)}},getStatusIcon=e=>{switch(e){case"pending":return(0,a.jsx)(p,{className:"h-4 w-4 text-yellow-500"});case"approved":return(0,a.jsx)(o,{className:"h-4 w-4 text-blue-500"});case"released":return(0,a.jsx)(h,{className:"h-4 w-4 text-green-500"});case"cancelled":return(0,a.jsx)(g,{className:"h-4 w-4 text-red-500"});default:return(0,a.jsx)(p,{className:"h-4 w-4 text-gray-500"})}},getStatusColor=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"released":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},getTotalItems=e=>e.order_details.reduce((e,t)=>e+t.quantity,0),getTotalAmount=e=>e.order_details.reduce((e,t)=>e+t.unit_price*t.quantity,0);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Customer Orders"})})}),(0,a.jsx)("div",{className:"flex flex-col sm:flex-row space-y-4 sm:space-y-0 sm:space-x-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Filter"}),(0,a.jsxs)("select",{value:C,onChange:e=>E(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"approved",children:"Approved"}),(0,a.jsx)("option",{value:"released",children:"Released"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})}),w?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading orders..."})]}):0===x.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(b.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No orders found"})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Details"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>{var t,r;return(0,a.jsxs)("tr",{className:"hover:bg-blue-100",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",e.id.slice(-8)]}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:null===(t=e.brand)||void 0===t?void 0:t.name})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:null===(r=e.location)||void 0===r?void 0:r.name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(getStatusColor(e.status)),children:[getStatusIcon(e.status),(0,a.jsx)("span",{className:"ml-1 capitalize",children:e.status})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,u.iI)(e.created_at,{dateStyle:"short"})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[getTotalItems(e)," items"]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["₱",getTotalAmount(e).toFixed(2)]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>S(e),className:"p-1 rounded ".concat("green"===c?"text-green-600 hover:text-green-900 hover:bg-green-100":"red"===c?"text-red-600 hover:text-red-900 hover:bg-red-100":"yellow"===c?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-100":"text-blue-600 hover:text-blue-900 hover:bg-blue-100"),title:"View Details",children:(0,a.jsx)(f,{className:"h-4 w-4"})}),"pending"===e.status&&(0,a.jsx)("button",{onClick:()=>updateOrderStatus(e.id,"approved"),disabled:N===e.id,className:"p-1 rounded ".concat(N===e.id?"text-gray-400 cursor-not-allowed":"text-green-600 hover:text-green-900 hover:bg-green-100"),title:"Approve Order",children:N===e.id?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}):(0,a.jsx)(o,{className:"h-4 w-4"})}),"approved"===e.status&&(0,a.jsx)("button",{onClick:()=>updateOrderStatus(e.id,"released"),disabled:N===e.id,className:"p-1 rounded ".concat(N===e.id?"text-gray-400 cursor-not-allowed":"green"===c?"text-green-600 hover:text-green-900 hover:bg-green-100":"red"===c?"text-red-600 hover:text-red-900 hover:bg-red-100":"yellow"===c?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-100":"text-blue-600 hover:text-blue-900 hover:bg-blue-100"),title:"Release Order",children:N===e.id?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}):(0,a.jsx)(h,{className:"h-4 w-4"})}),("pending"===e.status||"approved"===e.status)&&(0,a.jsx)("button",{onClick:()=>updateOrderStatus(e.id,"cancelled"),disabled:N===e.id,className:"".concat(N===e.id?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-900"),title:"Cancel Order",children:N===e.id?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}):(0,a.jsx)(g,{className:"h-4 w-4"})}),("cancelled"===e.status||"released"===e.status)&&(0,a.jsx)("button",{onClick:()=>handleDeleteOrder(e.id),disabled:N===e.id,className:"".concat(N===e.id?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-900"),title:"Delete Order",children:N===e.id?(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}):(0,a.jsx)(m,{className:"h-4 w-4"})})]})})]},e.id)})})]})})}),_&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Franchisee Details #",_.id.slice(-8)]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!_)return;let e=window.open("","_blank");if(e){var t,r,a;e.document.write("\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Receipt - Order ".concat(_.id.slice(0,8),'</title>\n          <style>\n            \n            * { box-sizing: border-box; }\n            body { \n              font-family: Arial, sans-serif; \n              margin: 0; \n              padding: 10px; \n              background: white;\n              color: black;\n              line-height: 1.4;\n            }\n            \n            .receipt-container {\n              max-width: 100%;\n              width: 100%;\n              margin: 0;\n              background: white;\n              box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n              border-radius: 8px;\n              overflow: hidden;\n              display: flex;\n              flex-direction: column;\n              min-height: 100vh;\n            }\n            \n            .header { \n              text-align: center; \n              padding: 16px 20px;\n              background: white;\n              color: black;\n              border-bottom: 2px solid black;\n            }\n            \n            .company-name { \n              font-size: 23px; \n              font-weight: bold; \n              margin-bottom: 4px;\n              color: black;\n            }\n            \n            .receipt-title { \n              font-size: 15px; \n              font-weight: normal; \n              color: black;\n            }\n            \n            .order-info { \n              padding: 8px 12px; \n              background: white;\n              border-bottom: 1px solid black;\n            }\n            \n            .info-grid {\n              display: grid;\n              grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n              gap: 4px 12px;\n            }\n            \n            .info-item {\n              display: flex;\n              flex-direction: column;\n            }\n            \n            .info-label { \n              font-weight: normal; \n              color: #666;\n              font-size: 12px;\n              text-transform: uppercase;\n              margin-bottom: 1px;\n            }\n            \n            .info-value { \n              font-weight: normal; \n              color: black;\n              font-size: 13px;\n            }\n            \n            .status-badge {\n              display: inline-block;\n              padding: 2px 6px;\n              border: 1px solid black;\n              font-size: 11px;\n              font-weight: normal;\n              text-transform: uppercase;\n            }\n            \n            .status-pending { background: white; color: black; }\n            .status-approved { background: white; color: black; }\n            .status-released { background: black; color: white; }\n            .status-cancelled { background: white; color: black; }\n            \n            .items { \n              padding: 8px 12px;\n              flex: 1;\n            }\n            \n            .items-title {\n              font-size: 13px;\n              font-weight: bold;\n              margin-bottom: 6px;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .items-header {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              padding: 4px 0;\n              border-bottom: 1px solid black;\n              margin-bottom: 4px;\n            }\n            \n            .header-cell {\n              font-size: 11px;\n              font-weight: bold;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .header-checkbox { text-align: center; }\n            .header-item { text-align: left; }\n            .header-qty { text-align: center; }\n            .header-price { text-align: center; }\n            .header-total { text-align: right; }\n            \n            .item-checkbox {\n              text-align: center;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n            }\n            \n            .checkbox {\n              width: 14px;\n              height: 14px;\n              border: 1px solid black;\n              background: white;\n              cursor: pointer;\n            }\n            \n            .item-row {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              align-items: center;\n              padding: 4px 0;\n              border-bottom: 1px solid #ccc;\n            }\n            \n            .item-row:last-child {\n              border-bottom: none;\n            }\n            \n            .item-name {\n              font-weight: normal;\n              color: black;\n              margin-bottom: 1px;\n              font-size: 12px;\n            }\n            \n            .item-details {\n              font-size: 10px;\n              color: #666;\n            }\n            \n            .item-quantity {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-unit-price {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-price {\n              text-align: right;\n              font-weight: bold;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-section { \n              padding: 8px 12px;\n              background: white;\n              border-top: 1px solid black;\n            }\n            \n            .total-row {\n              display: flex;\n              justify-content: space-between;\n              align-items: center;\n              margin-bottom: 4px;\n            }\n            \n            .total-label {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-value {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .grand-total {\n              border-top: 1px solid black;\n              padding-top: 4px;\n              margin-top: 4px;\n            }\n            \n            .grand-total .total-label {\n              font-size: 13px;\n              font-weight: bold;\n            }\n            \n            .grand-total .total-value {\n              font-size: 14px;\n              font-weight: bold;\n              color: black;\n            }\n            \n            .footer { \n              text-align: center; \n              padding: 6px 12px;\n              background: black;\n              color: white;\n              margin-top: auto;\n            }\n            \n            .footer-text {\n              font-size: 11px;\n              margin-bottom: 2px;\n            }\n            \n            .footer-date {\n              font-size: 10px;\n            }\n            \n            .notes {\n              padding: 6px 12px;\n              background: white;\n              border: 1px solid black;\n              margin: 0 12px 8px;\n            }\n            \n            .notes-title {\n              font-weight: bold;\n              color: black;\n              margin-bottom: 2px;\n              font-size: 11px;\n            }\n            \n            .notes-text {\n              color: black;\n              font-size: 11px;\n            }\n            \n            @media print { \n              body { margin: 0; padding: 0; }\n              .receipt-container { box-shadow: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="receipt-container">\n            <div class="header">\n              <div class="company-name">').concat((null===(t=_.brand)||void 0===t?void 0:t.name)||"Company",'</div>\n              <div class="receipt-title">Order Receipt</div>\n            </div>\n            \n            <div class="order-info">\n              <div class="info-grid">\n                <div class="info-item">\n                  <span class="info-label">Order ID</span>\n                  <span class="info-value">').concat(_.id.slice(0,8),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Date (PST)</span>\n                  <span class="info-value">').concat((0,u.iI)(_.created_at,{dateStyle:"short"}),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Location</span>\n                  <span class="info-value">').concat((null===(r=_.location)||void 0===r?void 0:r.name)||"N/A",'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Franchisee</span>\n                  <span class="info-value">').concat((null===(a=_.location)||void 0===a?void 0:a.franchisee)||"N/A",'</span>\n                </div>\n              </div>\n            </div>\n            \n            <div class="items">\n              <div class="items-header">\n                <div class="header-cell header-checkbox">✓</div>\n                <div class="header-cell header-item">Item</div>\n                <div class="header-cell header-qty">Quantity</div>\n                <div class="header-cell header-price">Unit Price</div>\n                <div class="header-cell header-total">Total</div>\n              </div>\n              ').concat(_.order_details.map(e=>'\n                <div class="item-row">\n                  <div class="item-checkbox">\n                    <div class="checkbox"></div>\n                  </div>\n                  <div>\n                    <div class="item-name">'.concat(e.product.name,'</div>\n                    <div class="item-details">\n                      ').concat(e.product.sku?"SKU: ".concat(e.product.sku):"",'\n                    </div>\n                  </div>\n                  <div class="item-quantity">').concat(e.quantity," ").concat(e.product.unit,'</div>\n                  <div class="item-unit-price">₱').concat(e.unit_price.toFixed(2),'</div>\n                  <div class="item-price">₱').concat((e.unit_price*e.quantity).toFixed(2),"</div>\n                </div>\n              ")).join(""),"\n            </div>\n            \n            ").concat(_.notes?'\n              <div class="notes">\n                <div class="notes-title">Notes</div>\n                <div class="notes-text">'.concat(_.notes,"</div>\n              </div>\n            "):"",'\n            \n            <div class="total-section">\n              <div class="total-row">\n                <span class="total-label">Total Items</span>\n                <span class="total-value">').concat(getTotalItems(_),'</span>\n              </div>\n              <div class="total-row grand-total">\n                <span class="total-label">Total Amount</span>\n                <span class="total-value">₱').concat(getTotalAmount(_).toFixed(2),'</span>\n              </div>\n            </div>\n            \n            <div class="footer">\n              <div class="footer-text">Thank you for your order!</div>\n              <div class="footer-date">Generated on ').concat(new Date().toLocaleString(),"</div>\n            </div>\n          </div>\n        </body>\n        </html>\n      ")),e.document.close(),e.focus(),e.print(),e.close()}},className:"flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium ".concat("green"===c?"bg-green-100 text-green-700 hover:bg-green-200":"red"===c?"bg-red-100 text-red-700 hover:bg-red-200":"yellow"===c?"bg-yellow-100 text-yellow-700 hover:bg-yellow-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:[(0,a.jsx)(y.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Print Receipt"})]}),(0,a.jsx)("button",{onClick:()=>S(null),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(g,{className:"h-6 w-6"})})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:null===(t=_.location)||void 0===t?void 0:t.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Franchisee"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:(null===(r=_.location)||void 0===r?void 0:r.franchisee)||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date & Time (PST)"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:(0,u.iI)(_.created_at)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Brand"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:null===(l=_.brand)||void 0===l?void 0:l.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(getStatusColor(_.status)),children:[getStatusIcon(_.status),(0,a.jsx)("span",{className:"ml-1 capitalize",children:_.status})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Amount"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["₱",getTotalAmount(_).toFixed(2)]})]})]}),_.notes&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),(0,a.jsx)("p",{className:"text-sm text-gray-900 bg-gray-50 p-3 rounded-lg",children:_.notes})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Order Items"}),(0,a.jsx)("div",{className:"space-y-2",children:_.order_details.map(e=>(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg hover:bg-blue-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.product.name}),e.product.sku&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["SKU: ",e.product.sku]})]}),(0,a.jsx)("div",{className:"text-right",children:(0,a.jsxs)("p",{className:"text-sm font-semibold text-gray-900",children:["₱",(e.unit_price*e.quantity).toFixed(2)]})})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:[e.quantity," ",e.product.unit]}),(0,a.jsxs)("span",{children:["₱",e.unit_price.toFixed(2)," per ",e.product.unit]})]})]},e.id))}),(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Items:"}),(0,a.jsx)("span",{className:"font-semibold",children:getTotalItems(_)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"font-medium",children:"Total Amount:"}),(0,a.jsxs)("span",{className:"text-lg font-bold text-gray-900",children:["₱",getTotalAmount(_).toFixed(2)]})]})]})]})]})]})})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let v=(0,l.Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function BranchManager(e){let{selectedBrand:t,theme:r="blue"}=e,[l,o]=(0,n.useState)([]),[p,h]=(0,n.useState)([]),[g,b]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[N,k]=(0,n.useState)(null),[_,S]=(0,n.useState)(null),[C,E]=(0,n.useState)([]),[O,P]=(0,n.useState)(!1),[z,q]=(0,n.useState)({name:"",passkey:"",franchisee:"",contact_number:"",brand_id:(null==t?void 0:t.id)||""});(0,n.useEffect)(()=>{t&&(fetchLocations(),fetchBrands(),q(e=>({...e,brand_id:t.id})))},[t]);let fetchLocations=async()=>{if(t){b(!0);try{let{data:e,error:r}=await s.O.from("locations").select("\n          *,\n          brand:brands(*)\n        ").eq("brand_id",t.id).order("name");if(r){console.error("Error fetching locations:",r);return}e&&o(e)}catch(e){console.error("Error fetching locations:",e)}finally{b(!1)}}},fetchBrands=async()=>{try{let{data:e,error:t}=await s.O.from("brands").select("*").order("name");if(t){console.error("Error fetching brands:",t);return}e&&h(e)}catch(e){console.error("Error fetching brands:",e)}},handleAddLocation=async e=>{if(e.preventDefault(),!z.name||!z.passkey||!z.franchisee||!z.contact_number){alert("Please fill in all required fields");return}try{let{data:e,error:r}=await s.O.from("locations").insert([z]).select();if(r){console.error("Error adding location:",r),alert("Error adding location");return}e&&(o([...l,e[0]]),q({name:"",passkey:"",franchisee:"",contact_number:"",brand_id:(null==t?void 0:t.id)||""}),j(!1))}catch(e){console.error("Error adding location:",e),alert("Error adding location")}},handleUpdateLocation=async e=>{try{let{data:t,error:r}=await s.O.from("locations").update({name:e.name,passkey:e.passkey,franchisee:e.franchisee,contact_number:e.contact_number,brand_id:e.brand_id,updated_at:new Date().toISOString()}).eq("id",e.id).select();if(r){console.error("Error updating location:",r),alert("Error updating location");return}t&&(o(l.map(r=>r.id===e.id?{...t[0],brand:e.brand}:r)),k(null))}catch(e){console.error("Error updating location:",e),alert("Error updating location")}},handleDeleteLocation=async e=>{if(confirm("Are you sure you want to delete this location?"))try{let{error:t}=await s.O.from("locations").delete().eq("id",e);if(t){console.error("Error deleting location:",t),alert("Error deleting location");return}o(l.filter(t=>t.id!==e))}catch(e){console.error("Error deleting location:",e),alert("Error deleting location")}},fetchLocationOrders=async e=>{b(!0);try{let{data:t,error:r}=await s.O.from("customer_orders").select("\n          *,\n          location:locations(*),\n          brand:brands(*),\n          order_details(\n            *,\n            product:products(id, name, sku, unit)\n          )\n        ").eq("location_id",e).order("created_at",{ascending:!1});if(r){console.error("Error fetching orders:",r);return}t&&E(t)}catch(e){console.error("Error fetching orders:",e)}finally{b(!1)}},handleViewOrderHistory=async e=>{S(e),P(!0),await fetchLocationOrders(e.id)},copyToClipboard=async e=>{try{await navigator.clipboard.writeText(e),console.log("Passkey copied to clipboard:",e)}catch(r){console.error("Failed to copy passkey:",r);let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}},getStatusBadge=e=>(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat({pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",released:"bg-green-100 text-green-800",cancelled:"bg-red-100 text-red-800"}[e]||"bg-gray-100 text-gray-800"),children:e.charAt(0).toUpperCase()+e.slice(1)}),getTotalItems=e=>e.order_details.reduce((e,t)=>e+t.quantity,0),getTotalAmount=e=>e.order_details.reduce((e,t)=>e+t.unit_price*t.quantity,0),handlePrintReceipt=e=>{let t=window.open("","_blank");if(t){var r,a,n;t.document.write("\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Receipt - Order ".concat(e.id.slice(0,8),'</title>\n          <style>\n            \n            * { box-sizing: border-box; }\n            body { \n              font-family: Arial, sans-serif; \n              margin: 0; \n              padding: 10px; \n              background: white;\n              color: black;\n              line-height: 1.4;\n            }\n            \n            .receipt-container {\n              max-width: 100%;\n              width: 100%;\n              margin: 0;\n              background: white;\n              box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n              border-radius: 8px;\n              overflow: hidden;\n              display: flex;\n              flex-direction: column;\n              min-height: 100vh;\n            }\n            \n            .header { \n              text-align: center; \n              padding: 16px 20px;\n              background: white;\n              color: black;\n              border-bottom: 2px solid black;\n            }\n            \n            .company-name { \n              font-size: 23px; \n              font-weight: bold; \n              margin-bottom: 4px;\n              color: black;\n            }\n            \n            .receipt-title { \n              font-size: 15px; \n              font-weight: normal; \n              color: black;\n            }\n            \n            .order-info { \n              padding: 8px 12px; \n              background: white;\n              border-bottom: 1px solid black;\n            }\n            \n            .info-grid {\n              display: grid;\n              grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n              gap: 4px 12px;\n            }\n            \n            .info-item {\n              display: flex;\n              flex-direction: column;\n            }\n            \n            .info-label { \n              font-weight: normal; \n              color: #666;\n              font-size: 12px;\n              text-transform: uppercase;\n              margin-bottom: 1px;\n            }\n            \n            .info-value { \n              font-weight: normal; \n              color: black;\n              font-size: 13px;\n            }\n            \n            .status-badge {\n              display: inline-block;\n              padding: 2px 6px;\n              border: 1px solid black;\n              font-size: 11px;\n              font-weight: normal;\n              text-transform: uppercase;\n            }\n            \n            .status-pending { background: white; color: black; }\n            .status-approved { background: white; color: black; }\n            .status-released { background: black; color: white; }\n            .status-cancelled { background: white; color: black; }\n            \n            .items { \n              padding: 8px 12px;\n              flex: 1;\n            }\n            \n            .items-title {\n              font-size: 13px;\n              font-weight: bold;\n              margin-bottom: 6px;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .items-header {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              padding: 4px 0;\n              border-bottom: 1px solid black;\n              margin-bottom: 4px;\n            }\n            \n            .header-cell {\n              font-size: 11px;\n              font-weight: bold;\n              color: black;\n              text-transform: uppercase;\n            }\n            \n            .header-checkbox { text-align: center; }\n            .header-item { text-align: left; }\n            .header-qty { text-align: center; }\n            .header-price { text-align: center; }\n            .header-total { text-align: right; }\n            \n            .item-checkbox {\n              text-align: center;\n              display: flex;\n              justify-content: center;\n              align-items: center;\n            }\n            \n            .checkbox {\n              width: 14px;\n              height: 14px;\n              border: 1px solid black;\n              background: white;\n              cursor: pointer;\n            }\n            \n            .item-row {\n              display: grid;\n              grid-template-columns: 30px 2fr 1fr 1fr 1fr;\n              gap: 8px;\n              align-items: center;\n              padding: 4px 0;\n              border-bottom: 1px solid #ccc;\n            }\n            \n            .item-row:last-child {\n              border-bottom: none;\n            }\n            \n            .item-name {\n              font-weight: normal;\n              color: black;\n              margin-bottom: 1px;\n              font-size: 12px;\n            }\n            \n            .item-details {\n              font-size: 10px;\n              color: #666;\n            }\n            \n            .item-quantity {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-unit-price {\n              text-align: center;\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .item-price {\n              text-align: right;\n              font-weight: bold;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-section { \n              padding: 8px 12px;\n              background: white;\n              border-top: 1px solid black;\n            }\n            \n            .total-row {\n              display: flex;\n              justify-content: space-between;\n              align-items: center;\n              margin-bottom: 4px;\n            }\n            \n            .total-label {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .total-value {\n              font-weight: normal;\n              color: black;\n              font-size: 12px;\n            }\n            \n            .grand-total {\n              border-top: 1px solid black;\n              padding-top: 4px;\n              margin-top: 4px;\n            }\n            \n            .grand-total .total-label {\n              font-size: 13px;\n              font-weight: bold;\n            }\n            \n            .grand-total .total-value {\n              font-size: 14px;\n              font-weight: bold;\n              color: black;\n            }\n            \n            .footer { \n              text-align: center; \n              padding: 6px 12px;\n              background: black;\n              color: white;\n              margin-top: auto;\n            }\n            \n            .footer-text {\n              font-size: 11px;\n              margin-bottom: 2px;\n            }\n            \n            .footer-date {\n              font-size: 10px;\n            }\n            \n            .notes {\n              padding: 6px 12px;\n              background: white;\n              border: 1px solid black;\n              margin: 0 12px 8px;\n            }\n            \n            .notes-title {\n              font-weight: bold;\n              color: black;\n              margin-bottom: 2px;\n              font-size: 11px;\n            }\n            \n            .notes-text {\n              color: black;\n              font-size: 11px;\n            }\n            \n            @media print { \n              body { margin: 0; padding: 0; }\n              .receipt-container { box-shadow: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="receipt-container">\n          <div class="header">\n              <div class="company-name">').concat((null===(r=e.brand)||void 0===r?void 0:r.name)||"Company",'</div>\n              <div class="receipt-title">Order Receipt</div>\n          </div>\n          \n          <div class="order-info">\n              <div class="info-grid">\n                <div class="info-item">\n                  <span class="info-label">Order ID</span>\n                  <span class="info-value">').concat(e.id.slice(0,8),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Date (PST)</span>\n                  <span class="info-value">').concat((0,u.iI)(e.created_at,{dateStyle:"short"}),'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Location</span>\n                  <span class="info-value">').concat((null===(a=e.location)||void 0===a?void 0:a.name)||"N/A",'</span>\n                </div>\n                <div class="info-item">\n                  <span class="info-label">Franchisee</span>\n                  <span class="info-value">').concat((null===(n=e.location)||void 0===n?void 0:n.franchisee)||"N/A",'</span>\n                </div>\n              </div>\n          </div>\n          \n          <div class="items">\n              <div class="items-header">\n                <div class="header-cell header-checkbox">✓</div>\n                <div class="header-cell header-item">Item</div>\n                <div class="header-cell header-qty">Quantity</div>\n                <div class="header-cell header-price">Unit Price</div>\n                <div class="header-cell header-total">Total</div>\n              </div>\n              ').concat(e.order_details.map(e=>'\n                <div class="item-row">\n                  <div class="item-checkbox">\n                    <div class="checkbox"></div>\n                  </div>\n                  <div>\n                    <div class="item-name">'.concat(e.product.name,'</div>\n                    <div class="item-details">\n                      ').concat(e.product.sku?"SKU: ".concat(e.product.sku):"",'\n                    </div>\n                  </div>\n                  <div class="item-quantity">').concat(e.quantity," ").concat(e.product.unit,'</div>\n                  <div class="item-unit-price">₱').concat(e.unit_price.toFixed(2),'</div>\n                  <div class="item-price">₱').concat((e.unit_price*e.quantity).toFixed(2),"</div>\n                </div>\n              ")).join(""),"\n          </div>\n          \n            ").concat(e.notes?'\n              <div class="notes">\n                <div class="notes-title">Notes</div>\n                <div class="notes-text">'.concat(e.notes,"</div>\n              </div>\n            "):"",'\n            \n            <div class="total-section">\n              <div class="total-row">\n                <span class="total-label">Total Items</span>\n                <span class="total-value">').concat(getTotalItems(e),'</span>\n              </div>\n              <div class="total-row grand-total">\n                <span class="total-label">Total Amount</span>\n                <span class="total-value">₱').concat(getTotalAmount(e).toFixed(2),'</span>\n              </div>\n          </div>\n          \n          <div class="footer">\n              <div class="footer-text">Thank you for your order!</div>\n              <div class="footer-date">Generated on ').concat(new Date().toLocaleString(),"</div>\n            </div>\n          </div>\n        </body>\n        </html>\n      ")),t.document.close(),t.focus(),t.print(),t.close()}};return O&&_?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Order History"}),(0,a.jsx)("p",{className:"text-gray-600",children:_.name})]}),(0,a.jsxs)("button",{onClick:()=>{P(!1),S(null)},className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Back to Branches"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsx)("h4",{className:"text-lg font-medium mb-4",children:"Branch Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-blue-600 font-medium",children:"Total Orders"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-900",children:C.length})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-green-600 font-medium",children:"Total Revenue"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-900",children:["₱",C.reduce((e,t)=>e+(t.total_amount||0),0).toFixed(2)]})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:"Franchisee"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-purple-900",children:_.franchisee||"N/A"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-orange-600 font-medium",children:"Contact"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-orange-900",children:_.contact_number||"N/A"})]})]})]}),g?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-blue-100",children:[(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[e.id.slice(0,8),"..."]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(e.created_at).toLocaleDateString()}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.customer_name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:getStatusBadge(e.status)}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["₱",e.total_amount.toFixed(2)]}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(null===(t=e.order_details)||void 0===t?void 0:t.length)||0," items"]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex space-x-2",children:(0,a.jsx)("button",{onClick:()=>handlePrintReceipt(e),className:"p-1 rounded text-blue-600 hover:text-blue-900 hover:bg-blue-50 transition-all duration-200 ease-in-out",title:"Print Receipt",children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})})})})]},e.id)})})]})})})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Branch Manager"})}),(0,a.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("green"===r?"bg-green-600 hover:bg-green-700":"red"===r?"bg-red-600 hover:bg-red-700":"yellow"===r?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Branch"})]})]}),w&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 shadow-lg rounded-md bg-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Branch"}),(0,a.jsx)("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("form",{onSubmit:handleAddLocation,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Branch Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:z.name,onChange:e=>q({...z,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent ".concat("green"===r?"focus:ring-green-500":"red"===r?"focus:ring-red-500":"yellow"===r?"focus:ring-yellow-500":"focus:ring-blue-500"),placeholder:"Enter branch name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Passkey *"}),(0,a.jsx)("input",{type:"text",required:!0,value:z.passkey,onChange:e=>q({...z,passkey:e.target.value.replace(/\D/g,"").slice(0,6)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent ".concat("green"===r?"focus:ring-green-500":"red"===r?"focus:ring-red-500":"yellow"===r?"focus:ring-yellow-500":"focus:ring-blue-500"),placeholder:"Enter 6-digit passkey",maxLength:6})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Franchisee Name *"}),(0,a.jsx)("input",{type:"text",required:!0,value:z.franchisee,onChange:e=>q({...z,franchisee:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent ".concat("green"===r?"focus:ring-green-500":"red"===r?"focus:ring-red-500":"yellow"===r?"focus:ring-yellow-500":"focus:ring-blue-500"),placeholder:"Enter franchisee name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number *"}),(0,a.jsx)("input",{type:"tel",required:!0,value:z.contact_number,onChange:e=>q({...z,contact_number:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent ".concat("green"===r?"focus:ring-green-500":"red"===r?"focus:ring-red-500":"yellow"===r?"focus:ring-yellow-500":"focus:ring-blue-500"),placeholder:"Enter contact number"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("green"===r?"bg-green-600 hover:bg-green-700":"red"===r?"bg-red-600 hover:bg-red-700":"yellow"===r?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Branch"})]})]})]})]})}),g?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Branch Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Passkey"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Franchisee"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-blue-100",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(null==N?void 0:N.id)===e.id?(0,a.jsx)("input",{type:"text",value:N.name,onChange:e=>k({...N,name:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded"}):e.name}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null==N?void 0:N.id)===e.id?(0,a.jsx)("input",{type:"text",value:N.passkey,onChange:e=>k({...N,passkey:e.target.value.replace(/\D/g,"").slice(0,6)}),className:"w-full px-2 py-1 border border-gray-300 rounded",maxLength:6}):(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"font-mono",children:e.passkey}),(0,a.jsx)("button",{onClick:()=>copyToClipboard(e.passkey),className:"p-1 rounded hover:bg-gray-100 transition-colors ".concat("green"===r?"text-green-600 hover:text-green-700":"red"===r?"text-red-600 hover:text-red-700":"yellow"===r?"text-yellow-600 hover:text-yellow-700":"text-blue-600 hover:text-blue-700"),title:"Copy passkey",children:(0,a.jsx)(v,{className:"h-4 w-4"})})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null==N?void 0:N.id)===e.id?(0,a.jsx)("input",{type:"text",value:N.franchisee||"",onChange:e=>k({...N,franchisee:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded"}):e.franchisee||"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(null==N?void 0:N.id)===e.id?(0,a.jsx)("input",{type:"tel",value:N.contact_number||"",onChange:e=>k({...N,contact_number:e.target.value}),className:"w-full px-2 py-1 border border-gray-300 rounded"}):e.contact_number||"N/A"}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,a.jsx)("div",{className:"flex space-x-2",children:(null==N?void 0:N.id)===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>handleUpdateLocation(N),className:"p-1 rounded transition-all duration-200 ease-in-out ".concat("green"===r?"text-green-600 hover:text-green-900 hover:bg-green-50":"red"===r?"text-red-600 hover:text-red-900 hover:bg-red-50":"yellow"===r?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-50":"text-blue-600 hover:text-blue-900 hover:bg-blue-50"),title:"Save",children:(0,a.jsx)(c,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>k(null),className:"p-1 rounded text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-all duration-200 ease-in-out",title:"Cancel",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>k(e),className:"p-1 rounded transition-all duration-200 ease-in-out ".concat("green"===r?"text-green-600 hover:text-green-900 hover:bg-green-50":"red"===r?"text-red-600 hover:text-red-900 hover:bg-red-50":"yellow"===r?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-50":"text-blue-600 hover:text-blue-900 hover:bg-blue-50"),title:"Edit",children:(0,a.jsx)(x,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>handleViewOrderHistory(e),className:"p-1 rounded text-green-600 hover:text-green-900 hover:bg-green-50 transition-all duration-200 ease-in-out",title:"View Order History",children:(0,a.jsx)(f,{className:"h-4 w-4"})}),(0,a.jsx)("button",{onClick:()=>handleDeleteLocation(e.id),className:"p-1 rounded text-red-600 hover:text-red-900 hover:bg-red-50 transition-all duration-200 ease-in-out",title:"Delete",children:(0,a.jsx)(m,{className:"h-4 w-4"})})]})})})]},e.id))})]})})})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let w=(0,l.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var j=r(4322);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let N=(0,l.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),k=(0,l.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),_=(0,l.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function StockReport(e){var t,r;let{selectedBrand:l,theme:i}=e,[c,x]=(0,n.useState)([]),[m,p]=(0,n.useState)(!1),[g,b]=(0,n.useState)(new Set),[y,v]=(0,n.useState)({}),[S,C]=(0,n.useState)([]),[E,O]=(0,n.useState)(null),[P,z]=(0,n.useState)(!1),fetchSummaries=async()=>{if(l){p(!0);try{let{data:e,error:t}=await s.O.from("daily_stock_summaries").select("\n          *,\n          brand:brands(*)\n        ").eq("brand_id",l.id).order("date",{ascending:!1});if(t){console.error("Error fetching summaries:",t),alert("Error fetching stock summaries");return}x(e||[])}catch(e){console.error("Error fetching summaries:",e),alert("Error fetching stock summaries")}finally{p(!1)}}},fetchAllReleasedOrders=async()=>{if(l)try{let{data:e,error:t}=await s.O.from("customer_orders").select("\n          *,\n          location:locations(*),\n          order_details(\n            *,\n            product:products(*)\n          )\n        ").eq("brand_id",l.id).eq("status","released").order("updated_at",{ascending:!1});if(t){console.error("Error fetching all released orders:",t);return}C(e||[])}catch(e){console.error("Error fetching all released orders:",e)}},fetchOrdersForDate=async e=>{if(l){z(!0);try{console.log("Fetching orders for date:",e,"brand:",l.id);let{data:t,error:r}=await s.O.from("customer_orders").select("\n          *,\n          location:locations(*),\n          order_details(\n            *,\n            product:products(*)\n          )\n        ").eq("brand_id",l.id).eq("status","released").order("updated_at",{ascending:!1});if(r){console.error("Error fetching orders for date:",r);return}let a=(t||[]).filter(t=>{try{let r=t.updated_at?(0,u.jA)(t.updated_at):"",a=t.created_at?(0,u.jA)(t.created_at):"";console.log("Order ".concat(t.id.slice(-8),": created=").concat(a,", updated=").concat(r,", target=").concat(e));let n=r===e||a===e;return console.log("  → Match: ".concat(n)),n}catch(e){return console.error("Error parsing dates for order ".concat(t.id,":"),e),console.error("Order data:",t),!1}});console.log("All released orders:",(null==t?void 0:t.length)||0),console.log("Raw orders data:",t),console.log("Filtered orders for date:",a.length),console.log("Filtered orders:",a),v(t=>({...t,[e]:a}))}catch(e){console.error("Error fetching orders for date:",e)}finally{z(!1)}}},toggleSummaryExpansion=async(e,t)=>{let r=new Set(g);r.has(e)?r.delete(e):(r.add(e),await fetchOrdersForDate(t)),b(r)};(0,n.useEffect)(()=>{l&&(fetchSummaries(),fetchAllReleasedOrders())},[l]);let formatDate=e=>{let t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})},getStatusIcon=e=>e.total_production>0&&e.total_released>0?(0,a.jsx)(w,{className:"h-4 w-4 text-blue-500"}):e.total_production>0?(0,a.jsx)(j.Z,{className:"h-4 w-4 text-green-500"}):e.total_released>0?(0,a.jsx)(h,{className:"h-4 w-4 text-orange-500"}):(0,a.jsx)(o,{className:"h-4 w-4 text-gray-500"}),getStatusColor=e=>e.total_production>0&&e.total_released>0?"bg-blue-100 text-blue-800":e.total_production>0?"bg-green-100 text-green-800":e.total_released>0?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800",getStatusText=e=>e.total_production>0&&e.total_released>0?"Active Day":e.total_production>0?"Production Only":e.total_released>0?"Release Only":"No Activity",getTotalItems=e=>{var t;return(null===(t=e.order_details)||void 0===t?void 0:t.reduce((e,t)=>e+t.quantity,0))||0},getTotalAmount=e=>{var t;return(null===(t=e.order_details)||void 0===t?void 0:t.reduce((e,t)=>e+t.unit_price*t.quantity,0))||0};return l?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-900",children:["Stock Reports for ",l.name]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Daily summaries of finalized stock operations"})]}),(0,a.jsxs)("button",{onClick:()=>{fetchSummaries(),fetchAllReleasedOrders()},className:"flex items-center space-x-2 px-4 py-2 text-white rounded-lg transition-colors ".concat("green"===i?"bg-green-600 hover:bg-green-700":"red"===i?"bg-red-600 hover:bg-red-700":"yellow"===i?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:[(0,a.jsx)(N,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Refresh"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg",children:(0,a.jsx)(j.Z,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Production"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:c.reduce((e,t)=>e+t.total_production,0)})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-orange-100 rounded-lg",children:(0,a.jsx)(h,{className:"h-6 w-6 text-orange-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Orders Released"}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:S.length})]})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,a.jsx)(o,{className:"h-6 w-6 text-green-600"})}),(0,a.jsxs)("div",{className:"ml-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount Released"}),(0,a.jsxs)("p",{className:"text-2xl font-semibold text-gray-900",children:["₱",S.reduce((e,t)=>e+getTotalAmount(t),0).toFixed(2)]})]})]})})]}),m?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading reports..."})]}):0===c.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(N,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No stock reports found"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:'Stock reports will appear here after using the "Finalize Stock" button'})]}):(0,a.jsx)("div",{className:"bg-white rounded-lg border shadow-sm overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-8"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Production"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Released"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Final Stock"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Finalized At"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(e=>{let t=g.has(e.id),r=y[e.date]||[];return(0,a.jsxs)(n.Fragment,{children:[(0,a.jsxs)("tr",{className:"hover:bg-blue-100",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("button",{onClick:()=>toggleSummaryExpansion(e.id,e.date),className:"text-gray-400 hover:text-gray-600",children:t?(0,a.jsx)(k,{className:"h-4 w-4"}):(0,a.jsx)(_,{className:"h-4 w-4"})})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:formatDate(e.date)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(getStatusColor(e)),children:[getStatusIcon(e),(0,a.jsx)("span",{className:"ml-1",children:getStatusText(e)})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.total_production}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.total_released}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-green-600",children:e.total_final_stock}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleString()})]}),t&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("tr",{className:"bg-gray-50",children:(0,a.jsxs)("td",{colSpan:7,className:"px-6 py-3",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:["Released Orders (",r.length,")"]}),P?(0,a.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Loading orders..."})]}):0===r.length?(0,a.jsx)("div",{className:"text-sm text-gray-500 py-4",children:"No orders were released on this date"}):(0,a.jsx)("div",{className:"space-y-2",children:r.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center justify-between bg-white rounded border p-3 hover:bg-blue-100",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["#",e.id.slice(-8)]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:null===(t=e.location)||void 0===t?void 0:t.name})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.customer_name}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[getTotalItems(e)," items"]}),(0,a.jsxs)("div",{className:"text-sm font-medium text-green-600",children:["₱",getTotalAmount(e).toFixed(2)]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:(0,u.iI)(e.updated_at)})]})}),(0,a.jsx)("button",{onClick:()=>O(e),className:"ml-4 px-3 py-1 text-xs rounded transition-all duration-200 ease-in-out ".concat("green"===i?"text-green-600 hover:text-green-900 hover:bg-green-50":"red"===i?"text-red-600 hover:text-red-900 hover:bg-red-50":"yellow"===i?"text-yellow-600 hover:text-yellow-900 hover:bg-yellow-50":"text-blue-600 hover:text-blue-900 hover:bg-blue-50"),children:(0,a.jsx)(f,{className:"h-5 w-5"})})]},e.id)})})]})})})]},e.id)})})]})})}),E&&(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,a.jsxs)("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Order Details - #",E.id.slice(-8)]}),(0,a.jsx)("button",{onClick:()=>O(null),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(d.Z,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Customer"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:E.customer_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:null===(t=E.location)||void 0===t?void 0:t.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Date & Time (PST)"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:(0,u.iI)(E.updated_at)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Total Amount"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-green-600",children:["₱",getTotalAmount(E).toFixed(2)]})]})]}),(0,a.jsxs)("div",{className:"border-t pt-4",children:[(0,a.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Order Items"}),(0,a.jsx)("div",{className:"space-y-2",children:null===(r=E.order_details)||void 0===r?void 0:r.map(e=>{var t,r;return(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded p-3",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:null===(t=e.product)||void 0===t?void 0:t.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["SKU: ",null===(r=e.product)||void 0===r?void 0:r.sku]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.quantity," \xd7 ₱",e.unit_price.toFixed(2)]}),(0,a.jsxs)("div",{className:"text-sm font-medium text-green-600",children:["₱",(e.quantity*e.unit_price).toFixed(2)]})]})]},e.id)})})]})]})})]}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(N,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Please select a brand to view stock reports"})]})}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let S=(0,l.Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),C=(0,l.Z)("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var E=r(6142);function DashboardPage(){let[e,t]=(0,n.useState)(!1),[r,s]=(0,n.useState)(""),[l,o]=(0,n.useState)(null),[i,d]=(0,n.useState)("products"),[c,x]=(0,n.useState)(""),[m,u]=(0,n.useState)(0),[p,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let initializeDashboard=async()=>{h(!0);let e=localStorage.getItem("dashboard_authenticated"),r=localStorage.getItem("dashboard_selected_brand"),a=localStorage.getItem("dashboard_active_tab");if("true"===e&&t(!0),r)try{o(JSON.parse(r))}catch(e){console.error("Error parsing saved brand:",e)}a&&["products","orders","branches","reports"].includes(a)&&d(a),setTimeout(()=>{h(!1)},800)};initializeDashboard()},[]),(0,n.useEffect)(()=>{l?localStorage.setItem("dashboard_selected_brand",JSON.stringify(l)):localStorage.removeItem("dashboard_selected_brand")},[l]),(0,n.useEffect)(()=>{localStorage.setItem("dashboard_active_tab",i)},[i]);let g=(e=>{if(!e)return"blue";switch(e.slug){case"mychoice":return"green";case"gelatofilipino":return"red";case"mang-sorbetes":return"yellow";default:return"blue"}})(l);return p?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full mb-4 ".concat("green"===g?"bg-green-100":"red"===g?"bg-red-100":"yellow"===g?"bg-yellow-100":"bg-blue-100"),children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 ".concat("green"===g?"border-green-600":"red"===g?"border-red-600":"yellow"===g?"border-yellow-600":"border-blue-600")})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Please wait while we check your session..."})]})}):e?(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-8 w-8 ".concat("green"===g?"text-green-600":"red"===g?"text-red-600":"yellow"===g?"text-yellow-600":"text-blue-600")}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Dashboard"}),l&&(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("green"===g?"bg-green-100 text-green-800":"red"===g?"bg-red-100 text-red-800":"yellow"===g?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"),children:l.name})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.jsx)("span",{children:"Admin Access"})]})]}),(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsxs)("button",{onClick:()=>{t(!1),s(""),o(null),d("products"),h(!1),localStorage.removeItem("dashboard_authenticated"),localStorage.removeItem("dashboard_selected_brand"),localStorage.removeItem("dashboard_active_tab")},className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,a.jsx)(S,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Logout"})]})})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,a.jsx)("div",{className:"flex-1 max-w-xs",children:(0,a.jsx)(BrandSelector,{onBrandChange:o})}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,a.jsx)("button",{onClick:()=>d("products"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("products"===i?"green"===g?"border-green-500 text-green-600":"red"===g?"border-red-500 text-red-600":"yellow"===g?"border-yellow-500 text-yellow-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Products & Inventory"})]})}),(0,a.jsx)("button",{onClick:()=>d("orders"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("orders"===i?"green"===g?"border-green-500 text-green-600":"red"===g?"border-red-500 text-red-600":"yellow"===g?"border-yellow-500 text-yellow-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Customer Orders"})]})}),(0,a.jsx)("button",{onClick:()=>d("branches"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("branches"===i?"green"===g?"border-green-500 text-green-600":"red"===g?"border-red-500 text-red-600":"yellow"===g?"border-yellow-500 text-yellow-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Branch Manager"})]})}),(0,a.jsx)("button",{onClick:()=>d("reports"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("reports"===i?"green"===g?"border-green-500 text-green-600":"red"===g?"border-red-500 text-red-600":"yellow"===g?"border-yellow-500 text-yellow-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(N,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Stock Reports"})]})})]})})})]})})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:["products"===i&&l&&(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(ProductManager,{selectedBrand:l,theme:g},m)}),"orders"===i&&(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(OrderManager,{selectedBrand:l,onOrderUpdate:()=>{u(e=>e+1)},theme:g},m)}),"branches"===i&&l&&(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(BranchManager,{selectedBrand:l,theme:g})}),!l&&"branches"===i&&(0,a.jsxs)("div",{className:"p-6 text-center py-12",children:[(0,a.jsx)(E.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Please select a brand to manage branches"})]}),"reports"===i&&(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(StockReport,{selectedBrand:l,theme:g})}),!l&&"products"===i&&(0,a.jsxs)("div",{className:"p-6 text-center py-12",children:[(0,a.jsx)(j.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Please select a brand to manage products"})]})]})]})]}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[(0,a.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 mb-4",children:(0,a.jsx)(S,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"Enter passcode to access inventory management"})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),"john101797"===r?(t(!0),localStorage.setItem("dashboard_authenticated","true"),x("")):(x("Invalid passcode. Please try again."),s(""))},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"passcode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Passcode"}),(0,a.jsx)("input",{type:"password",id:"passcode",value:r,onChange:e=>s(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg tracking-wider",placeholder:"Enter 6-digit passcode",maxLength:10,required:!0})]}),c&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-red-800 text-sm",children:c})}),(0,a.jsxs)("button",{type:"submit",className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,a.jsx)(C,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Access Dashboard"})]})]})]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)("p",{className:"text-center text-xs text-gray-500",children:"\xa9 Gilnaks Food Corporation"})})]})}},2899:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});var a=r(3082);let n=(0,a.createClientComponentClient)()},8939:function(e,t,r){"use strict";r.d(t,{iI:function(){return formatPhilippinesDateTime},jA:function(){return toPhilippinesDateString},sn:function(){return getPhilippinesDate}});let a="Asia/Manila";function toPhilippinesTime(e){let t=new Date(e);return new Date(t.toLocaleString("en-US",{timeZone:a}))}function getPhilippinesDate(){let e=new Date;return e.toLocaleDateString("en-CA",{timeZone:a})}function toPhilippinesDateString(e){let t=toPhilippinesTime(e);return t.toLocaleDateString("en-CA")}function formatPhilippinesDateTime(e,t){let r=toPhilippinesTime(e);return r.toLocaleString("en-US",{timeZone:a,...t})}}},function(e){e.O(0,[587,971,472,744],function(){return e(e.s=4264)}),_N_E=e.O()}]);